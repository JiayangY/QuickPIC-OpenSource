<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="">
    
    <meta name="author" content="Weiming An" >
    <link rel="icon" href="../favicon.png">

    <title>main.f03 &ndash; QuickPIC</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">QuickPIC </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../program/quickpic.html">Program</a></li>
	    
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/quickpic.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>main.f03
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 3.2% of total for source files.">650 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/main.f03"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">main.f03</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-0">Programs</a></h3></div>
  <div id="progs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/quickpic.html">quickpic</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/main.f03.html#src">main.f03</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
	<h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
	<div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~main.f03~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemainf03EfferentGraph" width="641pt" height="640pt"
 viewBox="0.00 0.00 641.00 639.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~main.f03~~EfferentGraph" class="graph" transform="scale(.5603 .5603) rotate(0) translate(4 1137.8201)">
<title>sourcefile~~main.f03~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1137.8201 1140.1064,-1137.8201 1140.1064,4 -4,4"/>
<!-- sourcefile~main.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node1" class="node">
<title>sourcefile~main.f03</title>
<polygon fill="none" stroke="#000000" points="1136.1064,-717.1812 1082.1064,-717.1812 1082.1064,-695.1703 1136.1064,-695.1703 1136.1064,-717.1812"/>
<text text-anchor="middle" x="1109.1064" y="-703.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">main.f03</text>
</g>
<!-- sourcefile~parallel_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node2" class="node">
<title>sourcefile~parallel_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node2"><a xlink:href=".././sourcefile/parallel_class.f03.html" xlink:title="parallel_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="93.1934,-680.1812 -.0645,-680.1812 -.0645,-658.1703 93.1934,-658.1703 93.1934,-680.1812"/>
<text text-anchor="middle" x="46.5645" y="-666.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~parallel_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge1" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~parallel_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-1129.1757C405.3711,-1127.2006 389.6574,-1140.0054 331.9746,-1129.1757"/>
</g>
<!-- sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node3" class="node">
<title>sourcefile~spect3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node3"><a xlink:href=".././sourcefile/spect3d_class.f03.html" xlink:title="spect3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="512.0797,-757.1812 415.9772,-757.1812 415.9772,-735.1703 512.0797,-735.1703 512.0797,-757.1812"/>
<text text-anchor="middle" x="464.0284" y="-743.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">spect3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge3" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-629.1757C688.1925,-615.1514 580.6426,-625.6818 548.0566,-648.1757 518.94,-668.2749 536.5322,-693.6277 512.0566,-719.1757 508.2517,-723.1474 503.733,-726.6971 499.0132,-729.8139"/>
<polygon fill="#000000" stroke="#000000" points="497.1996,-726.8203 490.4109,-734.9545 500.7904,-732.8292 497.1996,-726.8203"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C905.3917,-823.0871 878.6325,-779.2223 806.3298,-726.1757 761.0201,-692.9332 778.0689,-648.2857 725.2214,-629.1757"/>
</g>
<!-- sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node4" class="node">
<title>sourcefile~perrors_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node4"><a xlink:href=".././sourcefile/perrors_class.f03.html" xlink:title="perrors_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="234.5743,-680.1812 142.5036,-680.1812 142.5036,-658.1703 234.5743,-658.1703 234.5743,-680.1812"/>
<text text-anchor="middle" x="188.5389" y="-666.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">perrors_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge2" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-1129.1757C433.5503,-1131.0562 356.7318,-1109.0513 331.9746,-1091.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-1093.1757C612.9272,-1126.6708 580.9892,-1121.9593 464.0284,-1129.1757"/>
</g>
<!-- sourcefile~beam3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node5" class="node">
<title>sourcefile~beam3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node5"><a xlink:href=".././sourcefile/beam3d_class.f03.html" xlink:title="beam3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="903.6604,-834.1812 806.2195,-834.1812 806.2195,-812.1703 903.6604,-812.1703 903.6604,-834.1812"/>
<text text-anchor="middle" x="854.9399" y="-820.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">beam3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~beam3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge5" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~beam3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C967.1164,-808.4416 938.4304,-812.8364 913.91,-816.1526"/>
<polygon fill="#000000" stroke="#000000" points="913.1313,-812.7251 903.6771,-817.5072 914.05,-819.6646 913.1313,-812.7251"/>
</g>
<!-- sourcefile~field3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node6" class="node">
<title>sourcefile~field3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node6"><a xlink:href=".././sourcefile/field3d_class.f03.html" xlink:title="field3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="770.4385,-755.1812 680.0044,-755.1812 680.0044,-733.1703 770.4385,-733.1703 770.4385,-755.1812"/>
<text text-anchor="middle" x="725.2214" y="-741.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">field3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~field3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge4" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~field3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C927.5256,-816.5498 921.5938,-862.9274 854.9399,-862.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.9399,-862.1757C831.7452,-861.9142 823.215,-859.0802 806.3298,-843.1757 778.5368,-816.997 797.2832,-792.2182 770.3298,-765.1757 768.7443,-763.585 767.0156,-762.1007 765.189,-760.7178"/>
<polygon fill="#000000" stroke="#000000" points="767.006,-757.7253 756.6956,-755.2867 763.2349,-763.6227 767.006,-757.7253"/>
</g>
<!-- sourcefile~fdist2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node7" class="node">
<title>sourcefile~fdist2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node7"><a xlink:href=".././sourcefile/fdist2d_class.f03.html" xlink:title="fdist2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="509.2404,-63.1812 418.8165,-63.1812 418.8165,-41.1703 509.2404,-41.1703 509.2404,-63.1812"/>
<text text-anchor="middle" x="464.0284" y="-49.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdist2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~fdist2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge6" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~fdist2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M596.0848,-129.1757C552.0311,-120.6621 508.5687,-89.8101 484.1305,-69.8381"/>
<polygon fill="#000000" stroke="#000000" points="486.222,-67.0243 476.3101,-63.282 481.7249,-72.3886 486.222,-67.0243"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-91.1757C665.5536,-95.5417 654.8253,-140.5277 596.0848,-129.1757"/>
</g>
<!-- sourcefile~species2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node8" class="node">
<title>sourcefile~species2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node8"><a xlink:href=".././sourcefile/species2d_class.f03.html" xlink:title="species2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1045.8856,-717.1812 939.7709,-717.1812 939.7709,-695.1703 1045.8856,-695.1703 1045.8856,-717.1812"/>
<text text-anchor="middle" x="992.8282" y="-703.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">species2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~species2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge7" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~species2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1081.8444,-706.1757C1074.041,-706.1757 1065.1922,-706.1757 1056.175,-706.1757"/>
<polygon fill="#000000" stroke="#000000" points="1055.9694,-702.6758 1045.9694,-706.1757 1055.9694,-709.6758 1055.9694,-702.6758"/>
</g>
<!-- sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node9" class="node">
<title>sourcefile~spect2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node9"><a xlink:href=".././sourcefile/spect2d_class.f03.html" xlink:title="spect2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="380.0259,-372.1812 283.9233,-372.1812 283.9233,-350.1703 380.0259,-350.1703 380.0259,-372.1812"/>
<text text-anchor="middle" x="331.9746" y="-358.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">spect2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge8" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C935.7405,-815.3989 815.6298,-364.0041 770.3298,-327.1757 709.0814,-277.3815 491.2669,-278.3899 416.0002,-302.1757 390.6718,-310.1801 366.3584,-328.8585 350.4612,-343.0714"/>
<polygon fill="#000000" stroke="#000000" points="347.9178,-340.6563 342.9544,-350.0166 352.6716,-345.7946 347.9178,-340.6563"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1101.4223,-717.2223C1084.82,-739.847 1043.018,-790.403 992.8282,-803.1757"/>
</g>
<!-- sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node10" class="node">
<title>sourcefile~parallel_pipe_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node10"><a xlink:href=".././sourcefile/parallel_pipe_class.f03.html" xlink:title="parallel_pipe_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="247.8591,-566.1812 129.2187,-566.1812 129.2187,-544.1703 247.8591,-544.1703 247.8591,-566.1812"/>
<text text-anchor="middle" x="188.5389" y="-552.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">parallel_pipe_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge9" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-13.1757C244.9277,87.4263 197.4944,-422.9409 189.8144,-534.1348"/>
<polygon fill="#000000" stroke="#000000" points="186.3204,-533.9301 189.1584,-544.1377 193.3054,-534.3882 186.3204,-533.9301"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1107.8679,-695.1044C1097.7561,-610.4486 1021.4689,-69.4988 725.2214,-91.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M596.0848,-91.1757C549.1406,-41.7518 529.3406,-32.6905 464.0284,-13.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-91.1757C667.9657,-87.1933 635.6112,-132.79 596.0848,-91.1757"/>
</g>
<!-- sourcefile~field2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node11" class="node">
<title>sourcefile~field2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node11"><a xlink:href=".././sourcefile/field2d_class.f03.html" xlink:title="field2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="900.157,-717.1812 809.7229,-717.1812 809.7229,-695.1703 900.157,-695.1703 900.157,-717.1812"/>
<text text-anchor="middle" x="854.9399" y="-703.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">field2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~field2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge10" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~field2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C939.0673,-814.1861 890.0915,-757.0382 867.729,-725.6631"/>
<polygon fill="#000000" stroke="#000000" points="870.4629,-723.4623 861.9055,-717.2155 864.6996,-727.4353 870.4629,-723.4623"/>
</g>
<!-- sourcefile~input_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node12" class="node">
<title>sourcefile~input_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node12"><a xlink:href=".././sourcefile/input_class.f03.html" xlink:title="input_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="637.1293,-1065.1812 555.0404,-1065.1812 555.0404,-1043.1703 637.1293,-1043.1703 637.1293,-1065.1812"/>
<text text-anchor="middle" x="596.0848" y="-1051.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">input_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~input_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge11" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~input_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M992.8282,-803.1757C930.8052,-815.8782 945.7907,-867.017 903.55,-914.1757 828.6252,-997.8241 830.2394,-1053.4013 725.2214,-1093.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-1093.1757C707.476,-1098.4688 662.3762,-1082.3401 630.4893,-1069.2358"/>
<polygon fill="#000000" stroke="#000000" points="631.6386,-1065.9227 621.0625,-1065.2931 628.9376,-1072.3807 631.6386,-1065.9227"/>
</g>
<!-- sourcefile~fdist3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node13" class="node">
<title>sourcefile~fdist3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node13"><a xlink:href=".././sourcefile/fdist3d_class.f03.html" xlink:title="fdist3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="641.2968,-679.1812 550.8729,-679.1812 550.8729,-657.1703 641.2968,-657.1703 641.2968,-679.1812"/>
<text text-anchor="middle" x="596.0848" y="-665.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fdist3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~fdist3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge12" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~fdist3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-629.1757C707.7054,-622.5417 661.6636,-639.4233 629.5809,-653.0244"/>
<polygon fill="#000000" stroke="#000000" points="627.9122,-649.9325 620.1194,-657.1105 630.6876,-656.3589 627.9122,-649.9325"/>
</g>
<!-- sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node14" class="node">
<title>sourcefile~hdf5io_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node14"><a xlink:href=".././sourcefile/hdf5io_class.f03.html" xlink:title="hdf5io_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="375.8587,-796.1812 288.0905,-796.1812 288.0905,-774.1703 375.8587,-774.1703 375.8587,-796.1812"/>
<text text-anchor="middle" x="331.9746" y="-782.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">hdf5io_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~main.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge13" class="edge">
<title>sourcefile~main.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.9399,-862.1757C776.5153,-861.2913 753.7209,-859.1001 680.113,-886.1757 662.2936,-892.7304 662.2122,-903.4386 644.113,-909.1757 588.1071,-926.9287 570.7938,-913.8421 512.0566,-915.1757 469.3759,-916.1448 453.4965,-935.5869 416.0002,-915.1757 373.1395,-891.8445 348.806,-836.2022 338.2813,-805.8269"/>
<polygon fill="#000000" stroke="#000000" points="341.5747,-804.6377 335.1268,-796.2309 334.9248,-806.8238 341.5747,-804.6377"/>
</g>
<!-- sourcefile~spect3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge14" class="edge">
<title>sourcefile~spect3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M424.5575,-735.1435C375.3579,-721.3921 291.2558,-697.8854 237.8603,-682.9612"/>
<polygon fill="#000000" stroke="#000000" points="238.5097,-679.5086 227.9366,-680.1875 236.6254,-686.2502 238.5097,-679.5086"/>
</g>
<!-- sourcefile~spect3d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge16" class="edge">
<title>sourcefile~spect3d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M452.3271,-734.8426C440.9747,-723.0749 424.2848,-703.5621 416.0002,-683.1757 365.9414,-559.9925 455.7064,-495.4853 380.0002,-386.1757 377.9582,-383.2272 375.4579,-380.6023 372.6814,-378.2699"/>
<polygon fill="#000000" stroke="#000000" points="374.4894,-375.2646 364.2764,-372.446 370.5025,-381.0183 374.4894,-375.2646"/>
</g>
<!-- sourcefile~spect3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge15" class="edge">
<title>sourcefile~spect3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M455.7407,-734.9377C441.7278,-716.5083 411.762,-679.4853 380.0002,-655.1757 331.1684,-617.8011 266.3384,-587.2769 226.0409,-570.1619"/>
<polygon fill="#000000" stroke="#000000" points="227.1718,-566.8411 216.5961,-566.2056 224.4672,-573.2975 227.1718,-566.8411"/>
</g>
<!-- sourcefile~perrors_class.f03&#45;&gt;sourcefile~parallel_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge17" class="edge">
<title>sourcefile~perrors_class.f03&#45;&gt;sourcefile~parallel_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M142.4439,-669.1757C130.0495,-669.1757 116.4958,-669.1757 103.584,-669.1757"/>
<polygon fill="#000000" stroke="#000000" points="103.4011,-665.6758 93.4011,-669.1757 103.401,-672.6758 103.4011,-665.6758"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge19" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M596.0848,-707.1757C560.8973,-707.2348 522.5158,-720.1195 496.2464,-731.0613"/>
<polygon fill="#000000" stroke="#000000" points="494.6028,-727.9583 486.8033,-735.1289 497.3722,-734.3872 494.6028,-727.9583"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-705.1757C673.2004,-680.913 653.4857,-707.0794 596.0848,-707.1757"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge18" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M832.4375,-834.1871C824.1385,-838.3944 814.7177,-843.3446 806.3298,-848.1757 769.224,-869.5475 759.1888,-874.1026 725.2214,-900.1757"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~field3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge20" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~field3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M830.2213,-812.0638C822.3284,-808.1006 813.7272,-803.3292 806.3298,-798.1757 788.5205,-785.7686 788.3796,-777.2304 770.3298,-765.1757 767.6001,-763.3526 764.6868,-761.6081 761.7046,-759.9589"/>
<polygon fill="#000000" stroke="#000000" points="763.1603,-756.7718 752.6661,-755.3143 759.9608,-762.9979 763.1603,-756.7718"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge21" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.6875,-812.0832C838.8375,-794.3247 819.4776,-758.2444 806.3298,-726.1757 786.6559,-678.1892 786.8314,-664.3436 770.3298,-615.1757 731.4124,-499.2178 709.3585,-473.9424 680.113,-355.1757 654.3237,-250.4443 707.4957,-202.4478 644.113,-115.1757 630.0905,-95.8679 612.7221,-108.282 596.0848,-91.1757"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~fdist3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge22" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~fdist3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M825.8911,-812.0705C818.8832,-808.4146 811.8372,-803.807 806.3298,-798.1757 780.7571,-772.0278 796.8821,-749.3284 770.3298,-724.1757 754.5368,-709.2152 744.9366,-714.371 725.2214,-705.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-705.1757C701.8267,-694.2644 674.5209,-685.8715 651.0596,-679.8592"/>
<polygon fill="#000000" stroke="#000000" points="651.8114,-676.4397 641.2627,-677.4278 650.1252,-683.2336 651.8114,-676.4397"/>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge24" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M806.2859,-822.3418C769.8758,-823.5199 719.7417,-829.0605 680.113,-848.1757 660.2907,-857.7372 664.1085,-872.9818 644.113,-882.1757 570.9906,-915.7976 543.5644,-913.4784 464.0284,-901.1757"/>
</g>
<!-- sourcefile~part3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node18" class="node">
<title>sourcefile~part3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node18"><a xlink:href=".././sourcefile/part3d_class.f03.html" xlink:title="part3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="769.7693,-796.1812 680.6736,-796.1812 680.6736,-774.1703 769.7693,-774.1703 769.7693,-796.1812"/>
<text text-anchor="middle" x="725.2214" y="-782.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">part3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~beam3d_class.f03&#45;&gt;sourcefile~part3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge23" class="edge">
<title>sourcefile~beam3d_class.f03&#45;&gt;sourcefile~part3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M817.0713,-812.0824C803.218,-808.0242 787.3652,-803.3803 772.7734,-799.1057"/>
<polygon fill="#000000" stroke="#000000" points="773.4936,-795.6697 762.9129,-796.2172 771.5257,-802.3874 773.4936,-795.6697"/>
</g>
<!-- sourcefile~field3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge26" class="edge">
<title>sourcefile~field3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M701.5268,-733.0493C676.0579,-722.1296 634.0991,-707.1119 596.0848,-707.1757"/>
</g>
<!-- sourcefile~field3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge25" class="edge">
<title>sourcefile~field3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-939.1757C463.5524,-939.2076 332.3851,-901.419 331.9746,-901.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M697.7362,-755.2542C691.7278,-758.1404 685.5453,-761.489 680.113,-765.1757 661.9029,-777.5345 662.4141,-786.9521 644.113,-799.1757 605.2171,-825.155 581.7412,-809.7232 548.0566,-842.1757 522.005,-867.2746 537.569,-889.5289 512.0566,-915.1757 495.2277,-932.0935 487.8378,-937.5823 464.0284,-939.1757"/>
</g>
<!-- sourcefile~field3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge28" class="edge">
<title>sourcefile~field3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M695.0585,-733.0171C689.1889,-729.4758 683.7399,-724.9334 680.113,-719.1757 608.4475,-605.4055 718.189,-227.3914 644.113,-115.1757 630.9668,-95.2609 612.9588,-108.0486 596.0848,-91.1757"/>
</g>
<!-- sourcefile~field3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge29" class="edge">
<title>sourcefile~field3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.4942,-755.2417C655.1173,-762.2862 623.1244,-772.4759 596.0848,-785.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M596.0848,-785.1757C574.4859,-795.3203 565.127,-792.5016 548.0566,-809.1757 523.594,-833.0705 536.5193,-853.281 512.0566,-877.1757 494.9863,-893.8498 487.6106,-904.8234 464.0284,-901.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-901.1757C408.2765,-892.552 364.1795,-835.8868 343.9799,-805.0656"/>
<polygon fill="#000000" stroke="#000000" points="346.8033,-802.9824 338.4919,-796.4119 340.8918,-806.7314 346.8033,-802.9824"/>
</g>
<!-- sourcefile~ufield3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node16" class="node">
<title>sourcefile~ufield3d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node16"><a xlink:href=".././sourcefile/ufield3d_class.f03.html" xlink:title="ufield3d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="644.1413,-757.1812 548.0284,-757.1812 548.0284,-735.1703 644.1413,-735.1703 644.1413,-757.1812"/>
<text text-anchor="middle" x="596.0848" y="-743.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ufield3d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~field3d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge27" class="edge">
<title>sourcefile~field3d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.0557,-744.8752C671.8858,-745.0018 663.2589,-745.1354 654.7689,-745.2669"/>
<polygon fill="#000000" stroke="#000000" points="654.4653,-741.7711 644.5207,-745.4256 654.5737,-748.7702 654.4653,-741.7711"/>
</g>
<!-- sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge30" class="edge">
<title>sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-169.1757C231.076,-323.3649 312.5413,-402.5992 247.949,-575.1757 237.4227,-603.2997 217.7548,-631.9504 203.9405,-650.1049"/>
<polygon fill="#000000" stroke="#000000" points="201.0772,-648.0852 197.6948,-658.1256 206.6002,-652.3859 201.0772,-648.0852"/>
</g>
<!-- sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge32" class="edge">
<title>sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M433.4224,-63.4207C426.9434,-66.9862 420.6633,-71.5174 416.0002,-77.1757 407.3256,-87.7021 355.2883,-275.9498 337.7447,-340.0247"/>
<polygon fill="#000000" stroke="#000000" points="334.3224,-339.2709 335.0613,-349.84 341.0746,-341.117 334.3224,-339.2709"/>
</g>
<!-- sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge31" class="edge">
<title>sourcefile~fdist2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M438.5927,-63.3215C430.9884,-67.1945 422.8571,-71.9055 416.0002,-77.1757 372.0944,-110.922 362.2966,-122.8389 331.9746,-169.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-169.1757C318.9089,-189.1423 298.9999,-174.6597 283.949,-193.1757 239.9701,-247.2797 202.6909,-464.9716 191.7732,-534.0388"/>
<polygon fill="#000000" stroke="#000000" points="188.2809,-533.7181 190.1983,-544.138 195.1974,-534.7967 188.2809,-533.7181"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge33" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M984.7485,-717.3356C973.682,-732.9195 953.5859,-762.314 939.55,-789.1757 920.1706,-826.2641 936.7076,-850.6476 903.55,-876.1757 840.1831,-924.9621 788.6591,-851.4814 725.2214,-900.1757"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~fdist2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge34" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~fdist2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-129.1757C671.4187,-109.1923 652.4362,-140.066 596.0848,-129.1757"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge35" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-129.1757C690.9292,-116.4389 680.5608,-140.0532 644.113,-143.1757 601.5771,-146.8198 587.8443,-158.6525 548.0566,-143.1757 527.828,-135.3071 532.2852,-118.0443 512.0566,-110.1757 472.269,-94.699 450.6496,-85.2357 416.0002,-110.1757 396.554,-124.1728 353.0244,-281.954 337.5586,-339.9526"/>
<polygon fill="#000000" stroke="#000000" points="334.1121,-339.2949 334.932,-349.8579 340.8783,-341.0891 334.1121,-339.2949"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge36" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.9399,-265.1757C805.1169,-225.3043 819.9901,-189.2498 770.3298,-149.1757 753.2632,-135.4036 745.1526,-138.324 725.2214,-129.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-129.1757C698.0348,-116.6973 616.6859,-112.865 596.0848,-91.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M991.0119,-694.8264C980.6379,-631.5078 926.8097,-322.6903 854.9399,-265.1757"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~field2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge37" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~field2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M939.517,-706.1757C929.9445,-706.1757 919.9475,-706.1757 910.3181,-706.1757"/>
<polygon fill="#000000" stroke="#000000" points="910.051,-702.6758 900.051,-706.1757 910.0509,-709.6758 910.051,-702.6758"/>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge38" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.9399,-265.1757C851.6398,-262.3515 647.2465,-493.1676 644.113,-496.1757 637.1994,-502.813 520.0669,-601.9139 512.0566,-607.1757 472.1676,-633.3781 451.5574,-623.3421 416.0002,-655.1757 380.5147,-686.9453 353.8897,-737.0355 340.8651,-764.8514"/>
<polygon fill="#000000" stroke="#000000" points="337.6506,-763.4651 336.6907,-774.0164 344.021,-766.3667 337.6506,-763.4651"/>
</g>
<!-- sourcefile~part2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node20" class="node">
<title>sourcefile~part2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node20"><a xlink:href=".././sourcefile/part2d_class.f03.html" xlink:title="part2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640.6327,-255.1812 551.537,-255.1812 551.537,-233.1703 640.6327,-233.1703 640.6327,-255.1812"/>
<text text-anchor="middle" x="596.0848" y="-241.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">part2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~species2d_class.f03&#45;&gt;sourcefile~part2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge39" class="edge">
<title>sourcefile~species2d_class.f03&#45;&gt;sourcefile~part2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M854.9399,-265.1757C796.9048,-219.9375 707.6632,-223.8438 650.5898,-232.6202"/>
<polygon fill="#000000" stroke="#000000" points="649.9742,-229.1743 640.6711,-234.2442 651.1052,-236.0824 649.9742,-229.1743"/>
</g>
<!-- sourcefile~spect2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge40" class="edge">
<title>sourcefile~spect2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M328.3299,-372.6418C317.7957,-405.2157 285.6464,-500.7589 247.949,-575.1757 234.3038,-602.112 215.1558,-631.222 202.3223,-649.795"/>
<polygon fill="#000000" stroke="#000000" points="199.4404,-647.8087 196.5813,-658.0105 205.1783,-651.8184 199.4404,-647.8087"/>
</g>
<!-- sourcefile~spect2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge41" class="edge">
<title>sourcefile~spect2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M304.0066,-372.3049C296.9184,-376.0014 289.6939,-380.6229 283.949,-386.1757 238.7218,-429.891 208.719,-499.7224 195.7878,-534.3317"/>
<polygon fill="#000000" stroke="#000000" points="192.4463,-533.2797 192.3248,-543.8739 199.0263,-535.6678 192.4463,-533.2797"/>
</g>
<!-- sourcefile~parallel_pipe_class.f03&#45;&gt;sourcefile~parallel_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge42" class="edge">
<title>sourcefile~parallel_pipe_class.f03&#45;&gt;sourcefile~parallel_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M174.6673,-566.3141C149.9002,-586.2012 97.9028,-627.9531 68.3358,-651.6942"/>
<polygon fill="#000000" stroke="#000000" points="65.8894,-649.1698 60.2833,-658.16 70.2722,-654.6281 65.8894,-649.1698"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge43" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.6552,-717.4343C827.6699,-754.6995 759.4167,-873.1997 725.2214,-900.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-1091.1757C263.3222,-1042.0007 207.4686,-769.9158 192.4946,-690.7736"/>
<polygon fill="#000000" stroke="#000000" points="195.8611,-689.7342 190.5853,-680.5464 188.98,-691.0189 195.8611,-689.7342"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-900.1757C682.6861,-933.7312 689.5366,-961.6473 644.113,-991.1757 628.8461,-1001.1003 346.778,-1101.7793 331.9746,-1091.1757"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~field3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge45" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~field3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M817.0713,-717.2691C803.218,-721.3273 787.3652,-725.9712 772.7734,-730.2458"/>
<polygon fill="#000000" stroke="#000000" points="771.5257,-726.9641 762.9129,-733.1343 773.4936,-733.6818 771.5257,-726.9641"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge47" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-341.1757C711.5055,-336.3107 478.5426,-360.1099 464.0284,-361.1757"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge48" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M853.7494,-694.9421C848.5382,-648.31 825.4874,-465.9474 770.3298,-327.1757 729.8267,-225.2732 724.4521,-189.81 644.113,-115.1757 626.6303,-98.9345 612.9588,-108.0486 596.0848,-91.1757"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge50" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M848.8393,-695.0589C836.9089,-674.6351 808.3015,-631.7194 770.3298,-615.1757 679.7641,-575.7178 632.6889,-564.2202 548.0566,-615.1757 518.7605,-632.8144 537.0217,-659.8063 512.0566,-683.1757 477.9091,-715.1408 456.6719,-703.0752 416.0002,-726.1757 393.9586,-738.6949 370.476,-755.512 353.9553,-767.9885"/>
<polygon fill="#000000" stroke="#000000" points="351.8155,-765.2187 345.9951,-774.0716 356.0659,-770.7806 351.8155,-765.2187"/>
</g>
<!-- sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node15" class="node">
<title>sourcefile~ufield2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node15"><a xlink:href=".././sourcefile/ufield2d_class.f03.html" xlink:title="ufield2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="512.0849,-565.1812 415.972,-565.1812 415.972,-543.1703 512.0849,-543.1703 512.0849,-565.1812"/>
<text text-anchor="middle" x="464.0284" y="-551.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ufield2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge44" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-341.1757C646.2283,-312.8412 681.7114,-456.9095 644.113,-496.1757 612.4535,-529.2397 561.8921,-543.4931 522.3926,-549.6178"/>
<polygon fill="#000000" stroke="#000000" points="521.7594,-546.1724 512.3486,-551.0394 522.7405,-553.1033 521.7594,-546.1724"/>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge46" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M821.6326,-695.1668C785.626,-685.1075 727.089,-674.1681 680.113,-691.1757 660.5297,-698.2659 661.4501,-709.6344 644.113,-721.1757 639.4181,-724.3012 634.2856,-727.3349 629.1786,-730.1481"/>
<polygon fill="#000000" stroke="#000000" points="627.3146,-727.1747 620.1136,-734.9461 630.5892,-733.3615 627.3146,-727.1747"/>
</g>
<!-- sourcefile~fft2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node17" class="node">
<title>sourcefile~fft2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node17"><a xlink:href=".././sourcefile/fft2d_class.f03.html" xlink:title="fft2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.6082,-333.1812 556.5614,-333.1812 556.5614,-311.1703 635.6082,-311.1703 635.6082,-333.1812"/>
<text text-anchor="middle" x="596.0848" y="-319.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fft2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~fft2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge49" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~fft2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-341.1757C699.9318,-332.1044 670.3682,-327.3602 645.9139,-324.8808"/>
<polygon fill="#000000" stroke="#000000" points="646.0516,-321.3788 635.7737,-323.9508 645.4122,-328.3496 646.0516,-321.3788"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M853.2138,-694.9605C843.9017,-636.3608 797.3855,-367.0608 725.2214,-341.1757"/>
</g>
<!-- sourcefile~fpois2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node19" class="node">
<title>sourcefile~fpois2d_class.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node19"><a xlink:href=".././sourcefile/fpois2d_class.f03.html" xlink:title="fpois2d_class.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="642.719,-487.1812 549.4507,-487.1812 549.4507,-465.1703 642.719,-465.1703 642.719,-487.1812"/>
<text text-anchor="middle" x="596.0848" y="-473.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fpois2d_class.f03</text>
</a>
</g>
</g>
<!-- sourcefile~field2d_class.f03&#45;&gt;sourcefile~fpois2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge51" class="edge">
<title>sourcefile~field2d_class.f03&#45;&gt;sourcefile~fpois2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.2214,-341.1757C664.5833,-319.4251 620.3028,-412.6926 603.4998,-455.5931"/>
<polygon fill="#000000" stroke="#000000" points="600.1738,-454.4934 599.9101,-465.0849 606.7212,-456.9696 600.1738,-454.4934"/>
</g>
<!-- sourcefile~input_class.f03&#45;&gt;sourcefile~parallel_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge52" class="edge">
<title>sourcefile~input_class.f03&#45;&gt;sourcefile~parallel_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-1091.1757C404.273,-1103.7897 392.891,-1124.8158 331.9746,-1129.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-1129.1757C122.7455,-1144.1507 61.4034,-783.3662 49.1167,-690.6436"/>
<polygon fill="#000000" stroke="#000000" points="52.559,-689.9672 47.8281,-680.4872 45.6147,-690.8483 52.559,-689.9672"/>
</g>
<!-- sourcefile~input_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge54" class="edge">
<title>sourcefile~input_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M592.9969,-1042.8798C578.9306,-991.5464 521.2089,-782.2706 512.0566,-771.1757 509.5051,-768.0826 506.4703,-765.3261 503.1843,-762.88"/>
<polygon fill="#000000" stroke="#000000" points="504.9437,-759.8508 494.6305,-757.424 501.1793,-765.7525 504.9437,-759.8508"/>
</g>
<!-- sourcefile~input_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge53" class="edge">
<title>sourcefile~input_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M561.3592,-1065.2434C534.9038,-1073.3476 497.4582,-1084.1189 464.0284,-1091.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-1091.1757C406.6034,-1103.2978 379.6878,-1125.3523 331.9746,-1091.1757"/>
</g>
<!-- sourcefile~input_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge55" class="edge">
<title>sourcefile~input_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M554.7636,-1047.2238C515.8735,-1039.0508 457.5563,-1022.4386 416.0002,-991.1757 334.9847,-930.2273 325.4815,-897.6597 283.949,-805.1757 254.799,-740.2651 275.3444,-714.8462 247.949,-649.1757 236.3875,-621.4613 216.9424,-592.7224 203.4623,-574.4358"/>
<polygon fill="#000000" stroke="#000000" points="206.1904,-572.24 197.3846,-566.3486 200.5944,-576.4455 206.1904,-572.24"/>
</g>
<!-- sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge57" class="edge">
<title>sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.6431,-679.3046C564.6655,-683.3711 555.81,-688.2008 548.0566,-693.1757 530.9968,-704.1223 529.1164,-710.2292 512.0566,-721.1757 507.2108,-724.2851 501.9344,-727.3377 496.7109,-730.1827"/>
<polygon fill="#000000" stroke="#000000" points="494.6888,-727.2918 487.4702,-735.0469 497.9494,-733.486 494.6888,-727.2918"/>
</g>
<!-- sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge56" class="edge">
<title>sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-669.1757C406.5072,-657.5183 389.1908,-656.103 331.9746,-669.1757"/>
</g>
<!-- sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge58" class="edge">
<title>sourcefile~fdist3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.7173,-673.1069C525.0313,-674.7598 492.4534,-674.9364 464.0284,-669.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-669.1757C414.9676,-659.2329 424.7474,-616.6148 380.0002,-594.1757 342.3045,-575.2727 296.0714,-565.5318 258.4811,-560.5123"/>
<polygon fill="#000000" stroke="#000000" points="258.4789,-556.9849 248.1221,-559.218 257.611,-563.9309 258.4789,-556.9849"/>
</g>
<!-- sourcefile~hdf5io_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge59" class="edge">
<title>sourcefile~hdf5io_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M307.2533,-773.9874C299.5201,-770.0518 291.1359,-765.3158 283.949,-760.1757 253.6471,-738.504 223.3119,-707.6082 205.2328,-687.9757"/>
<polygon fill="#000000" stroke="#000000" points="207.5852,-685.36 198.2708,-680.311 202.4037,-690.0666 207.5852,-685.36"/>
</g>
<!-- sourcefile~hdf5io_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge60" class="edge">
<title>sourcefile~hdf5io_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M322.4281,-774.0429C312.1977,-761.8113 295.8293,-741.3484 283.949,-722.1757 264.8946,-691.4256 265.637,-680.7316 247.949,-649.1757 233.1712,-622.8119 214.2502,-593.5397 201.7797,-574.7754"/>
<polygon fill="#000000" stroke="#000000" points="204.5319,-572.5948 196.0625,-566.2293 198.7137,-576.4871 204.5319,-572.5948"/>
</g>
<!-- sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge61" class="edge">
<title>sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-669.1757C303.7921,-675.6149 271.6736,-676.214 244.9843,-674.9456"/>
<polygon fill="#000000" stroke="#000000" points="244.8496,-671.4321 234.6648,-674.3511 244.4469,-678.4205 244.8496,-671.4321"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M438.6281,-565.3678C431.0253,-569.2428 422.8859,-573.9432 416.0002,-579.1757 372.4302,-612.2858 385.3231,-656.9867 331.9746,-669.1757"/>
</g>
<!-- sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge62" class="edge">
<title>sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M433.2526,-543.0678C426.7806,-539.4966 420.5462,-534.9286 416.0002,-529.1757 375.3663,-477.754 420.6336,-437.5979 380.0002,-386.1757 377.5143,-383.0298 374.5234,-380.2381 371.2649,-377.77"/>
<polygon fill="#000000" stroke="#000000" points="373.051,-374.7572 362.7488,-372.2839 369.26,-380.6419 373.051,-374.7572"/>
</g>
<!-- sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge64" class="edge">
<title>sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M436.7906,-543.0589C429.545,-539.3175 422.0577,-534.6702 416.0002,-529.1757 365.3198,-483.2058 399.6343,-389.9824 331.9746,-400.1757"/>
</g>
<!-- sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge65" class="edge">
<title>sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M454.5022,-565.3215C444.289,-577.5641 427.9348,-598.0364 416.0002,-617.1757 399.2892,-643.9751 359.7647,-726.3936 341.5147,-764.9262"/>
<polygon fill="#000000" stroke="#000000" points="338.2717,-763.5971 337.1633,-774.1338 344.6005,-766.5881 338.2717,-763.5971"/>
</g>
<!-- sourcefile~ufield2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node23" class="node">
<title>sourcefile~ufield2d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node23"><a xlink:href=".././sourcefile/ufield2d_lib.f03.html" xlink:title="ufield2d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="373.1146,-527.1812 290.8347,-527.1812 290.8347,-505.1703 373.1146,-505.1703 373.1146,-527.1812"/>
<text text-anchor="middle" x="331.9746" y="-513.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ufield2d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~ufield2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge63" class="edge">
<title>sourcefile~ufield2d_class.f03&#45;&gt;sourcefile~ufield2d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M425.478,-543.0824C411.3753,-539.0242 395.2372,-534.3803 380.3827,-530.1057"/>
<polygon fill="#000000" stroke="#000000" points="380.9226,-526.6191 370.3447,-527.2172 378.9868,-533.3461 380.9226,-526.6191"/>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge69" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M548.0359,-746.1757C539.7521,-746.1757 531.0596,-746.1757 522.5364,-746.1757"/>
<polygon fill="#000000" stroke="#000000" points="522.263,-742.6758 512.2629,-746.1757 522.2629,-749.6758 522.263,-742.6758"/>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge66" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-901.1757C248.7054,-854.7589 207.6978,-737.8719 193.9785,-690.0555"/>
<polygon fill="#000000" stroke="#000000" points="197.2946,-688.9146 191.2622,-680.2048 190.5465,-690.7755 197.2946,-688.9146"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M588.3795,-757.2833C556.8663,-801.3041 434.6028,-958.3838 331.9746,-901.1757"/>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge70" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-785.1757C333.5449,-785.4028 232.1826,-631.3337 199.6197,-575.2664"/>
<polygon fill="#000000" stroke="#000000" points="202.4948,-573.2421 194.5069,-566.2819 196.4109,-576.7042 202.4948,-573.2421"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M571.8821,-757.3574C545.8605,-768.4111 502.9721,-783.8632 464.0284,-785.1757"/>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge71" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-785.1757C438.466,-785.2202 410.1201,-785.226 386.2646,-785.2183"/>
<polygon fill="#000000" stroke="#000000" points="385.9941,-781.7183 375.9926,-785.2141 385.9911,-788.7183 385.9941,-781.7183"/>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge68" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M584.7547,-735.1307C574.0073,-724.1076 558.0559,-706.2505 548.0566,-688.1757 523.3598,-643.5335 545.1154,-618.0342 512.0566,-579.1757 509.3156,-575.9539 506.0542,-573.0922 502.5401,-570.5637"/>
<polygon fill="#000000" stroke="#000000" points="504.3475,-567.5661 494.0076,-565.2556 500.6498,-573.5098 504.3475,-567.5661"/>
</g>
<!-- sourcefile~ufield3d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node21" class="node">
<title>sourcefile~ufield3d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node21"><a xlink:href=".././sourcefile/ufield3d_lib.f03.html" xlink:title="ufield3d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="505.1684,-835.1812 422.8885,-835.1812 422.8885,-813.1703 505.1684,-813.1703 505.1684,-835.1812"/>
<text text-anchor="middle" x="464.0284" y="-821.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ufield3d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~ufield3d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge67" class="edge">
<title>sourcefile~ufield3d_class.f03&#45;&gt;sourcefile~ufield3d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.6431,-757.3046C564.6655,-761.3711 555.81,-766.2008 548.0566,-771.1757 530.9968,-782.1223 529.1164,-788.2292 512.0566,-799.1757 507.2108,-802.2851 501.9344,-805.3377 496.7109,-808.1827"/>
<polygon fill="#000000" stroke="#000000" points="494.6888,-805.2918 487.4702,-813.0469 497.9494,-811.486 494.6888,-805.2918"/>
</g>
<!-- sourcefile~fft2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge72" class="edge">
<title>sourcefile~fft2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M591.9187,-333.2312C583.3551,-356.0759 563.2997,-410.1992 548.0566,-456.1757 530.8016,-508.2208 549.2345,-533.874 512.0566,-574.1757 496.4918,-591.0485 480.8609,-577.5673 464.0284,-593.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-593.1757C446.5308,-609.4009 436.8403,-605.5517 416.0002,-617.1757 377.6456,-638.569 374.7889,-659.3936 331.9746,-669.1757"/>
</g>
<!-- sourcefile~fft2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge74" class="edge">
<title>sourcefile~fft2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M570.3942,-333.3338C544.2224,-343.8405 502.1743,-358.3745 464.0284,-361.1757"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M464.0284,-361.1757C439.9377,-362.9448 413.3081,-363.2577 390.3104,-363.0133"/>
<polygon fill="#000000" stroke="#000000" points="390.071,-359.5096 380.0216,-362.8651 389.9701,-366.5089 390.071,-359.5096"/>
</g>
<!-- sourcefile~fft2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge75" class="edge">
<title>sourcefile~fft2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M557.4481,-311.1231C492.3726,-295.0917 360.5264,-274.1081 283.949,-341.1757 223.9884,-393.6901 199.9206,-491.1855 191.9282,-534.0394"/>
<polygon fill="#000000" stroke="#000000" points="188.475,-533.4682 190.1933,-543.9227 195.3696,-534.6785 188.475,-533.4682"/>
</g>
<!-- sourcefile~fft2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge73" class="edge">
<title>sourcefile~fft2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M591.8326,-333.2513C580.7435,-361.5408 549.2111,-438.3063 512.0566,-496.1757 503.1635,-510.0271 491.4006,-524.2832 481.7419,-535.1954"/>
<polygon fill="#000000" stroke="#000000" points="478.9547,-533.0595 474.8483,-542.8262 484.149,-537.752 478.9547,-533.0595"/>
</g>
<!-- sourcefile~fft2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node26" class="node">
<title>sourcefile~fft2d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node26"><a xlink:href=".././sourcefile/fft2d_lib.f03.html" xlink:title="fft2d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="497.1333,-333.1812 430.9236,-333.1812 430.9236,-311.1703 497.1333,-311.1703 497.1333,-333.1812"/>
<text text-anchor="middle" x="464.0284" y="-319.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fft2d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~fft2d_class.f03&#45;&gt;sourcefile~fft2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge76" class="edge">
<title>sourcefile~fft2d_class.f03&#45;&gt;sourcefile~fft2d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M556.4636,-322.1757C541.0079,-322.1757 523.241,-322.1757 507.4397,-322.1757"/>
<polygon fill="#000000" stroke="#000000" points="507.3839,-318.6758 497.3838,-322.1757 507.3838,-325.6758 507.3839,-318.6758"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge78" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~spect3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M697.1072,-774.0893C691.2582,-771.2416 685.3005,-767.9111 680.113,-764.1757 661.2337,-750.5815 663.3851,-739.2073 644.113,-726.1757 625.0969,-713.3173 619.0403,-707.1372 596.0848,-707.1757"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge77" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M717.1449,-796.3393C700.4228,-819.1856 662.0744,-870.1375 644.113,-882.1757 574.3763,-928.9153 547.7647,-933.1728 464.0284,-939.1757"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge80" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M690.6517,-774.0572C686.5446,-771.4155 682.8478,-768.166 680.113,-764.1757 612.1232,-664.972 687.9216,-336.1794 644.113,-224.1757 619.3544,-160.8762 584.6568,-162.4492 548.0566,-105.1757 528.577,-74.6932 538.6565,-56.6929 512.0566,-32.1757 495.1773,-16.618 484.8797,-22.7768 464.0284,-13.1757"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~fdist3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge81" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~fdist3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.8679,-773.9423C688.8938,-771.253 684.0874,-768.0189 680.113,-764.1757 654.6793,-739.5815 668.9968,-718.3264 644.113,-693.1757 640.9024,-689.9306 637.1815,-687.0171 633.2596,-684.4261"/>
<polygon fill="#000000" stroke="#000000" points="634.868,-681.3117 624.4726,-679.2656 631.323,-687.3478 634.868,-681.3117"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge83" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M680.4361,-776.0618C654.596,-772.9762 622.161,-772.9284 596.0848,-785.1757"/>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge79" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~ufield3d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M688.5615,-774.1042C674.2481,-769.7815 657.6689,-764.7745 642.5348,-760.2039"/>
<polygon fill="#000000" stroke="#000000" points="643.4213,-756.8156 632.8364,-757.2749 641.3975,-763.5166 643.4213,-756.8156"/>
</g>
<!-- sourcefile~part3d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node25" class="node">
<title>sourcefile~part3d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node25"><a xlink:href=".././sourcefile/part3d_lib.f03.html" xlink:title="part3d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="633.7164,-873.1812 558.4533,-873.1812 558.4533,-851.1703 633.7164,-851.1703 633.7164,-873.1812"/>
<text text-anchor="middle" x="596.0848" y="-859.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">part3d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~part3d_class.f03&#45;&gt;sourcefile~part3d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge82" class="edge">
<title>sourcefile~part3d_class.f03&#45;&gt;sourcefile~part3d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M703.7563,-796.2892C696.1548,-800.4285 687.6279,-805.308 680.113,-810.1757 663.3269,-821.0489 661.0399,-826.5229 644.113,-837.1757 639.2401,-840.2425 633.9496,-843.2729 628.7203,-846.1087"/>
<polygon fill="#000000" stroke="#000000" points="626.6992,-843.2171 619.4771,-850.969 629.957,-849.4128 626.6992,-843.2171"/>
</g>
<!-- sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge84" class="edge">
<title>sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M587.6167,-487.3504C570.1017,-510.2353 530.0318,-561.3606 512.0566,-574.1757 493.3651,-587.5017 480.8609,-577.5673 464.0284,-593.1757"/>
</g>
<!-- sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge86" class="edge">
<title>sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M574.2691,-487.2759C537.7644,-504.1155 463.6269,-530.7012 416.0002,-496.1757 374.3519,-465.9841 413.2791,-425.4013 380.0002,-386.1757 377.2637,-382.9503 374.0053,-380.0862 370.4931,-377.5563"/>
<polygon fill="#000000" stroke="#000000" points="372.3024,-374.5599 361.9632,-372.2465 368.6031,-380.5026 372.3024,-374.5599"/>
</g>
<!-- sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge87" class="edge">
<title>sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.9746,-400.1757C261.2692,-410.8279 215.0484,-495.2052 197.0412,-534.7965"/>
<polygon fill="#000000" stroke="#000000" points="193.7985,-533.476 192.9825,-544.0394 200.2078,-536.2905 193.7985,-533.476"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M577.5654,-464.9989C534.9985,-440.6153 426.5719,-385.9241 331.9746,-400.1757"/>
</g>
<!-- sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge85" class="edge">
<title>sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.6431,-487.3046C564.6655,-491.3711 555.81,-496.2008 548.0566,-501.1757 530.9968,-512.1223 529.1164,-518.2292 512.0566,-529.1757 507.2108,-532.2851 501.9344,-535.3377 496.7109,-538.1827"/>
<polygon fill="#000000" stroke="#000000" points="494.6888,-535.2918 487.4702,-543.0469 497.9494,-541.486 494.6888,-535.2918"/>
</g>
<!-- sourcefile~fpois2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node24" class="node">
<title>sourcefile~fpois2d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node24"><a xlink:href=".././sourcefile/fpois2d_lib.f03.html" xlink:title="fpois2d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="503.7457,-487.1812 424.3111,-487.1812 424.3111,-465.1703 503.7457,-465.1703 503.7457,-487.1812"/>
<text text-anchor="middle" x="464.0284" y="-473.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fpois2d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~fpois2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge88" class="edge">
<title>sourcefile~fpois2d_class.f03&#45;&gt;sourcefile~fpois2d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M549.1549,-476.1757C537.803,-476.1757 525.6272,-476.1757 514.1355,-476.1757"/>
<polygon fill="#000000" stroke="#000000" points="513.8176,-472.6758 503.8176,-476.1757 513.8176,-479.6758 513.8176,-472.6758"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~perrors_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge89" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~perrors_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M585.2965,-255.5456C574.9508,-266.8096 559.2884,-284.8399 548.0566,-302.1757 528.3867,-332.5358 534.3559,-346.6909 512.0566,-375.1757 477.6329,-419.1484 449.6425,-411.6024 416.0002,-456.1757 392.5117,-487.2962 404.9165,-506.1861 380.0002,-536.1757 335.1297,-590.1826 263.1461,-632.0711 221.4043,-653.4632"/>
<polygon fill="#000000" stroke="#000000" points="219.5843,-650.461 212.2275,-658.0852 222.7331,-656.7128 219.5843,-650.461"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~fdist2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge92" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~fdist2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M586.579,-233.0173C576.3832,-220.7638 560.0438,-200.2823 548.0566,-181.1757 529.2538,-151.2056 531.459,-139.7613 512.0566,-110.1757 503.0298,-96.4112 491.2646,-82.1565 481.6382,-71.2233"/>
<polygon fill="#000000" stroke="#000000" points="484.0579,-68.6791 474.7745,-63.5732 478.8475,-73.3539 484.0579,-68.6791"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge93" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~spect2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M567.5577,-233.1103C530.263,-220.5647 464.0424,-205.024 416.0002,-231.1757 373.1395,-254.507 348.806,-310.1492 338.2813,-340.5246"/>
<polygon fill="#000000" stroke="#000000" points="334.9248,-339.5276 335.1268,-350.1206 341.5747,-341.7137 334.9248,-339.5276"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge94" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~parallel_pipe_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M585.2867,-233.0687C574.3212,-221.1784 557.6316,-201.2939 548.0566,-181.1757 518.7789,-119.6599 556.7521,-83.5927 512.0566,-32.1757 496.9966,-14.8509 484.8797,-22.7768 464.0284,-13.1757"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge95" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~hdf5io_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M551.4064,-245.3791C509.4807,-249.1046 448.4999,-261.715 416.0002,-302.1757 362.743,-368.4789 402.4486,-601.1482 380.0002,-683.1757 371.7862,-713.1901 355.252,-745.2642 343.8997,-765.2637"/>
<polygon fill="#000000" stroke="#000000" points="340.7933,-763.6437 338.8022,-774.0498 346.848,-767.1565 340.7933,-763.6437"/>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge90" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~ufield2d_class.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M583.7806,-255.3554C572.6427,-266.2057 556.6984,-283.7023 548.0566,-302.1757 510.8985,-381.6084 549.2148,-416.7431 512.0566,-496.1757 505.1702,-510.8968 493.6466,-524.9975 483.6133,-535.609"/>
<polygon fill="#000000" stroke="#000000" points="480.8595,-533.417 476.3327,-542.9961 485.8451,-538.3307 480.8595,-533.417"/>
</g>
<!-- sourcefile~part2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_node22" class="node">
<title>sourcefile~part2d_lib.f03</title>
<g id="a_sourcefile~~main.f03~~EfferentGraph_node22"><a xlink:href=".././sourcefile/part2d_lib.f03.html" xlink:title="part2d_lib.f03">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="501.66,-141.1812 426.3969,-141.1812 426.3969,-119.1703 501.66,-119.1703 501.66,-141.1812"/>
<text text-anchor="middle" x="464.0284" y="-127.0257" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">part2d_lib.f03</text>
</a>
</g>
</g>
<!-- sourcefile~part2d_class.f03&#45;&gt;sourcefile~part2d_lib.f03 -->
<g id="sourcefile~~main.f03~~EfferentGraph_edge91" class="edge">
<title>sourcefile~part2d_class.f03&#45;&gt;sourcefile~part2d_lib.f03</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M568.1095,-233.0528C561.0209,-229.3563 553.7975,-224.7332 548.0566,-219.1757 524.6083,-196.4764 535.505,-177.8751 512.0566,-155.1757 508.7377,-151.9628 504.9233,-149.0622 500.9258,-146.4724"/>
<polygon fill="#000000" stroke="#000000" points="502.4103,-143.2873 492.0038,-141.2987 498.8988,-149.3429 502.4103,-143.2873"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemainf03EfferentGraph = svgPanZoom('#sourcefilemainf03EfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#progs-1">Programs</a></h3></div>
  <div id="progs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../program/quickpic.html">quickpic</a>
      
    </div>
  </div>
</div>

















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/main.f03.html#src">main.f03</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! Main program for QuickPIC Open Source 1.0</span>
<a name="ln-2"></a><span class="c">! update: 04/18/2016</span>
<a name="ln-3"></a>
<a name="ln-4"></a>      <span class="k">program </span><span class="n">quickpic</span>
<a name="ln-5"></a>      
<a name="ln-6"></a>      <span class="k">use </span><span class="n">parallel_class</span>
<a name="ln-7"></a>      <span class="k">use </span><span class="n">parallel_pipe_class</span>
<a name="ln-8"></a>      <span class="k">use </span><span class="n">perrors_class</span>
<a name="ln-9"></a>      <span class="k">use </span><span class="n">spect3d_class</span>
<a name="ln-10"></a>      <span class="k">use </span><span class="n">spect2d_class</span>
<a name="ln-11"></a>      <span class="k">use </span><span class="n">field2d_class</span>
<a name="ln-12"></a>      <span class="k">use </span><span class="n">fdist2d_class</span>
<a name="ln-13"></a>      <span class="k">use </span><span class="n">field3d_class</span>
<a name="ln-14"></a>      <span class="k">use </span><span class="n">beam3d_class</span>
<a name="ln-15"></a>      <span class="k">use </span><span class="n">species2d_class</span>
<a name="ln-16"></a>      <span class="k">use </span><span class="n">fdist3d_class</span>
<a name="ln-17"></a>      <span class="k">use </span><span class="n">hdf5io_class</span>
<a name="ln-18"></a>      <span class="k">use </span><span class="n">input_class</span>
<a name="ln-19"></a>      <span class="k">use </span><span class="n">mpi</span>
<a name="ln-20"></a>
<a name="ln-21"></a>      <span class="k">implicit none</span>
<a name="ln-22"></a><span class="k">      </span>
<a name="ln-23"></a><span class="k">      type</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sim</span>
<a name="ln-24"></a>      <span class="k">class</span><span class="p">(</span><span class="n">parallel_pipe</span><span class="p">),</span><span class="k">pointer</span> <span class="kd">::</span> <span class="n">pp</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-25"></a>      <span class="k">class</span><span class="p">(</span><span class="n">perrors</span><span class="p">),</span><span class="k">pointer</span> <span class="kd">::</span> <span class="n">perr</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-26"></a>      <span class="k">class</span><span class="p">(</span><span class="n">spect3d</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">psp3</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-27"></a>      <span class="k">class</span><span class="p">(</span><span class="n">spect2d</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">psp2</span> <span class="o">=&gt;</span> <span class="nb">null</span><span class="p">()</span>
<a name="ln-28"></a>
<a name="ln-29"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field2d</span><span class="p">)</span> <span class="kd">::</span> <span class="n">qb</span><span class="p">,</span> <span class="n">qe</span><span class="p">,</span> <span class="n">qi</span><span class="p">,</span> <span class="n">psit</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">div_vpot</span><span class="p">,</span> <span class="n">reg</span>
<a name="ln-30"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field2d</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fxy</span><span class="p">,</span> <span class="n">bxyz</span><span class="p">,</span> <span class="n">cu</span><span class="p">,</span> <span class="n">dcu</span><span class="p">,</span> <span class="n">amu</span><span class="p">,</span> <span class="n">epw</span><span class="p">,</span> <span class="n">epwb</span>
<a name="ln-31"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field2d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qe0</span><span class="p">,</span> <span class="n">cu0</span><span class="p">,</span> <span class="n">dcu0</span><span class="p">,</span> <span class="n">amu0</span>
<a name="ln-32"></a>      
<a name="ln-33"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field3d</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bexyz</span><span class="p">,</span> <span class="n">bbxyz</span><span class="p">,</span> <span class="n">qeb</span>
<a name="ln-34"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field3d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qep</span>
<a name="ln-35"></a>      <span class="k">type</span><span class="p">(</span><span class="n">field3d</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">psi3d</span><span class="p">,</span><span class="n">cu3d</span>
<a name="ln-36"></a>      	
<a name="ln-37"></a>      <span class="k">type</span><span class="p">(</span><span class="n">fdist2d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pf</span>
<a name="ln-38"></a>      <span class="k">type</span><span class="p">(</span><span class="n">species2d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">spe</span>
<a name="ln-39"></a>      <span class="k">type</span><span class="p">(</span><span class="n">fdist3d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pf3</span>
<a name="ln-40"></a>      <span class="k">type</span><span class="p">(</span><span class="n">beam3d</span><span class="p">),</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">beam</span>
<a name="ln-41"></a>
<a name="ln-42"></a>      <span class="k">type</span><span class="p">(</span><span class="n">hdf5file</span><span class="p">)</span> <span class="kd">::</span> <span class="n">file2d</span><span class="p">,</span><span class="n">file3d</span><span class="p">,</span><span class="n">filep</span><span class="p">,</span><span class="n">file_rst</span>
<a name="ln-43"></a>
<a name="ln-44"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ierr</span><span class="p">,</span> <span class="n">iter</span><span class="p">,</span> <span class="n">nstep3d</span><span class="p">,</span> <span class="n">nstep2d</span><span class="p">,</span> <span class="n">start3d</span>
<a name="ln-45"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span> <span class="kd">::</span> <span class="n">id</span>
<a name="ln-46"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tag</span>
<a name="ln-47"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tag_spe</span><span class="p">,</span> <span class="n">id_spe</span><span class="p">,</span> <span class="n">id_br</span>
<a name="ln-48"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tag_beam</span><span class="p">,</span> <span class="n">id_beam</span><span class="p">,</span> <span class="n">id_qep</span><span class="p">,</span> <span class="n">id_qeps</span>
<a name="ln-49"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">istat</span>
<a name="ln-50"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span>
<a name="ln-51"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">erstr</span>
<a name="ln-52"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">stime</span>
<a name="ln-53"></a>      
<a name="ln-54"></a>      <span class="kt">real</span> <span class="kd">::</span> <span class="n">dex</span><span class="p">,</span> <span class="n">dxi</span><span class="p">,</span> <span class="n">dex2</span>
<a name="ln-55"></a>      
<a name="ln-56"></a>      
<a name="ln-57"></a>      <span class="k">call </span><span class="n">initialization</span><span class="p">()</span>                  
<a name="ln-58"></a>      
<a name="ln-59"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">start3d</span><span class="p">,</span> <span class="n">nstep3d</span>
<a name="ln-60"></a>
<a name="ln-61"></a>         <span class="k">write</span> <span class="p">(</span><span class="n">erstr</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;3D step:&#39;</span><span class="p">,</span> <span class="n">i</span>        
<a name="ln-62"></a>         <span class="k">call </span><span class="n">perr</span><span class="p">%</span><span class="n">werrfl0</span><span class="p">(</span><span class="n">erstr</span><span class="p">)</span>
<a name="ln-63"></a>         
<a name="ln-64"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-65"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-66"></a>         <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-67"></a>         <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-68"></a>            <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">qdp</span><span class="p">(</span><span class="n">qeb</span><span class="p">)</span>
<a name="ln-69"></a>         <span class="k">end do</span>
<a name="ln-70"></a><span class="k">         </span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-71"></a>         <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">ag</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-72"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-73"></a>         <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">pcg</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>    
<a name="ln-74"></a>
<a name="ln-75"></a>         <span class="k">do </span><span class="n">l</span> <span class="o">=</span>  <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-76"></a>            <span class="n">tag_spe</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-77"></a>            <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">precv</span><span class="p">(</span><span class="n">qe0</span><span class="p">(</span><span class="n">l</span><span class="p">),</span><span class="n">tag_spe</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<a name="ln-78"></a>         <span class="k">end do</span>
<a name="ln-79"></a><span class="k">         </span><span class="n">tag</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-80"></a>         <span class="k">call </span><span class="n">qi</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-81"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-82"></a>         <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-83"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-84"></a>         <span class="k">call </span><span class="n">epw</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-85"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-86"></a>         <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-87"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-88"></a>         <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-89"></a>         <span class="n">tag</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-90"></a>         <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">precv</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-91"></a>
<a name="ln-92"></a>         <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bexyz</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>         
<a name="ln-93"></a>         <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bexyz</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-94"></a>         <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bbxyz</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-95"></a>
<a name="ln-96"></a>
<a name="ln-97"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">pp</span><span class="p">%</span><span class="n">getstageid</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-98"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-99"></a>               <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>           
<a name="ln-100"></a>               <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">qdp</span><span class="p">(</span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-101"></a>               <span class="k">call </span><span class="n">qi</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">qi</span><span class="p">,</span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-102"></a>               <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">cb</span><span class="p">(</span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>         
<a name="ln-103"></a>            <span class="k">end do</span>
<a name="ln-104"></a><span class="k">         end if</span>
<a name="ln-105"></a><span class="k">                  </span>
<a name="ln-106"></a><span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nstep2d</span>
<a name="ln-107"></a>            <span class="k">write</span> <span class="p">(</span><span class="n">erstr</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;2D step:&#39;</span><span class="p">,</span> <span class="n">j</span>
<a name="ln-108"></a>            <span class="k">call </span><span class="n">perr</span><span class="p">%</span><span class="n">werrfl0</span><span class="p">(</span><span class="n">erstr</span><span class="p">)</span>
<a name="ln-109"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="n">nstep2d</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-110"></a><span class="k">               call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-111"></a>            <span class="n">endif</span>
<a name="ln-112"></a>            <span class="k">call </span><span class="n">qb</span><span class="p">%</span><span class="n">cp</span><span class="p">(</span><span class="n">qeb</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-113"></a>            <span class="k">call </span><span class="n">qb</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-114"></a>            <span class="k">call </span><span class="n">qb</span><span class="p">%</span><span class="n">elf</span><span class="p">(</span><span class="n">epwb</span><span class="p">)</span>
<a name="ln-115"></a>            <span class="k">call </span><span class="n">qe</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">qi</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<a name="ln-116"></a>            <span class="k">do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-117"></a>               <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-118"></a>               <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">qdp</span><span class="p">(</span><span class="n">qe0</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>                     
<a name="ln-119"></a>               <span class="k">call </span><span class="n">qe</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">qe</span><span class="p">,</span><span class="n">qe0</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<a name="ln-120"></a>            <span class="k">end do</span>
<a name="ln-121"></a><span class="k">            call </span><span class="n">qe</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-122"></a>            <span class="k">call </span><span class="n">qe</span><span class="p">%</span><span class="n">pot</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<a name="ln-123"></a>            <span class="k">call </span><span class="n">psi</span><span class="p">%</span><span class="n">grad</span><span class="p">(</span><span class="n">fxy</span><span class="p">)</span>
<a name="ln-124"></a>            <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-125"></a>            <span class="k">call </span><span class="n">psi</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-126"></a>            <span class="k">do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>            
<a name="ln-127"></a>               <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">l</span><span class="p">)%</span><span class="n">extpsi</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-128"></a>            <span class="k">end do</span>
<a name="ln-129"></a><span class="k">            call </span><span class="n">psi</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span><span class="n">dex</span><span class="o">*</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-130"></a>            <span class="k">if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">psi3d</span><span class="p">))</span> <span class="k">call </span><span class="n">psi</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">psi3d</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-131"></a>            <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">div</span><span class="p">(</span><span class="n">div_vpot</span><span class="p">)</span>
<a name="ln-132"></a>            <span class="k">call </span><span class="n">div_vpot</span><span class="p">%</span><span class="n">pot</span><span class="p">(</span><span class="n">psit</span><span class="p">)</span>
<a name="ln-133"></a>            <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">psit</span><span class="p">,</span><span class="o">-</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-134"></a>            <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-135"></a>            <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">bf</span><span class="p">(</span><span class="n">bxyz</span><span class="p">)</span>
<a name="ln-136"></a>            <span class="k">do </span><span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iter</span>
<a name="ln-137"></a>               <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">epw</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/-</span><span class="n">dex</span><span class="p">,</span><span class="n">dex</span><span class="o">/</span><span class="p">))</span>
<a name="ln-138"></a>               <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="n">dex</span><span class="o">/</span><span class="p">))</span>
<a name="ln-139"></a>               <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">sub</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,</span><span class="n">epwb</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-140"></a>               <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,</span><span class="n">epwb</span><span class="p">,(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-141"></a>               <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-142"></a>               <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-143"></a>               <span class="k">call </span><span class="n">dcu</span><span class="p">%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-144"></a>               <span class="k">call </span><span class="n">amu</span><span class="p">%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-145"></a>               <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-146"></a>                  <span class="k">call </span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-147"></a>                  <span class="k">call </span><span class="n">dcu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-148"></a>                  <span class="k">call </span><span class="n">amu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<a name="ln-149"></a>                  <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">amjdp</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="n">bxyz</span><span class="p">,</span><span class="n">psit</span><span class="p">,</span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">amu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">dcu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-150"></a>                  <span class="k">call </span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">mult</span><span class="p">(</span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-151"></a>                  <span class="k">call </span><span class="n">amu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">mult</span><span class="p">(</span><span class="n">amu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-152"></a>                  <span class="k">call </span><span class="n">dcu0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">mult</span><span class="p">(</span><span class="n">dcu0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-153"></a>                  <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">cu</span><span class="p">,</span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-154"></a>                  <span class="k">call </span><span class="n">amu</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">amu</span><span class="p">,</span><span class="n">amu0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-155"></a>                  <span class="k">call </span><span class="n">dcu</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">dcu</span><span class="p">,</span><span class="n">dcu0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-156"></a>               <span class="k">end do</span>
<a name="ln-157"></a><span class="k">               if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">iter</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-158"></a><span class="k">                  do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>              
<a name="ln-159"></a>                     <span class="k">call </span><span class="n">reg</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">cu0</span><span class="p">(</span><span class="n">m</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-160"></a>                     <span class="k">call </span><span class="n">reg</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-161"></a>                     <span class="k">call </span><span class="n">reg</span><span class="p">%</span><span class="n">smooth</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
<a name="ln-162"></a>                     <span class="k">call </span><span class="n">reg</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-163"></a>                     <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">as</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
<a name="ln-164"></a>                     <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">cb</span><span class="p">(</span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>                     
<a name="ln-165"></a>                  <span class="k">end do</span>
<a name="ln-166"></a><span class="k">                  if</span> <span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">cu3d</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-167"></a><span class="k">                     call </span><span class="n">cu</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">cu3d</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-168"></a>                  <span class="k">end if               </span>
<a name="ln-169"></a><span class="k">               </span><span class="n">endif</span>
<a name="ln-170"></a>               <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-171"></a>               <span class="k">call </span><span class="n">dcu</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-172"></a>               <span class="k">call </span><span class="n">amu</span><span class="p">%</span><span class="n">fftrk</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-173"></a>               <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">bfqp</span><span class="p">(</span><span class="n">dcu</span><span class="p">,</span><span class="n">amu</span><span class="p">,</span><span class="n">epw</span><span class="p">,</span><span class="n">dex2</span><span class="p">,</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-174"></a>               <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">div</span><span class="p">(</span><span class="n">div_vpot</span><span class="p">)</span>
<a name="ln-175"></a>               <span class="k">call </span><span class="n">div_vpot</span><span class="p">%</span><span class="n">pot</span><span class="p">(</span><span class="n">psit</span><span class="p">)</span>
<a name="ln-176"></a>               <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">psit</span><span class="p">,</span><span class="o">-</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-177"></a>               <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-178"></a>               <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">bf</span><span class="p">(</span><span class="n">bxyz</span><span class="p">)</span>
<a name="ln-179"></a>            <span class="n">enddo</span>
<a name="ln-180"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">epw</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/-</span><span class="n">dex</span><span class="p">,</span><span class="n">dex</span><span class="o">/</span><span class="p">))</span>
<a name="ln-181"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="n">dex</span><span class="o">/</span><span class="p">))</span>
<a name="ln-182"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">sub</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,</span><span class="n">epwb</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-183"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,</span><span class="n">epwb</span><span class="p">,(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-184"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">fftkr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-185"></a>            <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
<a name="ln-186"></a>            <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">add</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="n">bxyz</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-187"></a>            <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">sub</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="n">bxyz</span><span class="p">,(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">))</span>
<a name="ln-188"></a>            <span class="k">call </span><span class="n">dcu</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">dcu</span><span class="p">,</span><span class="n">dxi</span><span class="p">)</span>
<a name="ln-189"></a>            <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">sub</span><span class="p">(</span><span class="n">cu</span><span class="p">,</span><span class="n">dcu</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-190"></a>            <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>              
<a name="ln-191"></a>               <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">push</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="n">bxyz</span><span class="p">,</span><span class="n">psit</span><span class="p">,</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-192"></a>            <span class="k">end do</span>
<a name="ln-193"></a><span class="k">            call </span><span class="n">fxy</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">fxy</span><span class="p">,</span><span class="n">dex</span><span class="p">)</span>
<a name="ln-194"></a>            <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bexyz</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">))</span>
<a name="ln-195"></a>            <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bexyz</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-196"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">mult</span><span class="p">(</span><span class="n">bxyz</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="n">dex</span><span class="p">,</span><span class="n">dex</span><span class="o">/</span><span class="p">))</span>
<a name="ln-197"></a>            <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">cb</span><span class="p">(</span><span class="n">bbxyz</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="p">))</span>
<a name="ln-198"></a>         <span class="n">enddo</span>
<a name="ln-199"></a>         
<a name="ln-200"></a>         <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>                       
<a name="ln-201"></a>            <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag_spe</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">id_spe</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-202"></a>         <span class="k">end do</span>
<a name="ln-203"></a><span class="k">         call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-204"></a>         <span class="k">call </span><span class="n">qi</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-205"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-206"></a>         <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-207"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-208"></a>         <span class="k">call </span><span class="n">epw</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-209"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-210"></a>         <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<a name="ln-211"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-212"></a>         <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-213"></a>         <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-214"></a>         <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">psend</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-215"></a>
<a name="ln-216"></a>         <span class="k">call </span><span class="n">diagnostic</span><span class="p">()</span>
<a name="ln-217"></a>
<a name="ln-218"></a>         <span class="k">do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-219"></a>            <span class="n">tag_beam</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-220"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_beam</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-221"></a>            <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">push</span><span class="p">(</span><span class="n">bexyz</span><span class="p">,</span><span class="n">bbxyz</span><span class="p">,</span><span class="n">dex</span><span class="p">,</span><span class="n">dxi</span><span class="p">,</span><span class="n">tag_beam</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">tag_beam</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">id_beam</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-222"></a>         <span class="k">end do</span>
<a name="ln-223"></a><span class="k">         </span>
<a name="ln-224"></a><span class="k">         do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>                       
<a name="ln-225"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_spe</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-226"></a>            <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">renew</span><span class="p">(</span><span class="n">pf</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">qe0</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-227"></a>         <span class="k">end do</span>
<a name="ln-228"></a><span class="k">                          </span>
<a name="ln-229"></a><span class="k">      </span><span class="n">enddo</span>
<a name="ln-230"></a>      
<a name="ln-231"></a>      <span class="k">call </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-232"></a>      
<a name="ln-233"></a>      <span class="k">stop</span>
<a name="ln-234"></a><span class="k">      </span>
<a name="ln-235"></a><span class="k">      contains</span>
<a name="ln-236"></a><span class="c">!</span>
<a name="ln-237"></a>      <span class="k">subroutine </span><span class="n">initialization</span><span class="p">()</span>
<a name="ln-238"></a>
<a name="ln-239"></a>         <span class="k">implicit none</span>
<a name="ln-240"></a><span class="k">         </span>
<a name="ln-241"></a><span class="k">         </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">nd</span>
<a name="ln-242"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sn</span><span class="p">,</span> <span class="n">sid</span>
<a name="ln-243"></a>         
<a name="ln-244"></a>         
<a name="ln-245"></a>         <span class="k">call </span><span class="n">sim</span><span class="p">%</span><span class="n">new</span><span class="p">()</span>
<a name="ln-246"></a>         <span class="n">perr</span> <span class="o">=&gt;</span> <span class="n">sim</span><span class="p">%</span><span class="n">err</span>
<a name="ln-247"></a>         <span class="n">pp</span> <span class="o">=&gt;</span> <span class="n">sim</span><span class="p">%</span><span class="n">pp</span>
<a name="ln-248"></a>         <span class="n">psp3</span> <span class="o">=&gt;</span> <span class="n">sim</span><span class="p">%</span><span class="n">sp</span>
<a name="ln-249"></a>         <span class="n">psp2</span> <span class="o">=&gt;</span> <span class="n">sim</span><span class="p">%</span><span class="n">sp</span>
<a name="ln-250"></a>         
<a name="ln-251"></a>         <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-252"></a>         <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-253"></a>         <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-254"></a>         
<a name="ln-255"></a>         <span class="k">call </span><span class="n">qb</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="n">gcells</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-256"></a>         <span class="k">call </span><span class="n">qe</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-257"></a>         <span class="k">call </span><span class="n">qi</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="n">gcells</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-258"></a>         <span class="k">call </span><span class="n">psit</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-259"></a>         <span class="k">call </span><span class="n">div_vpot</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-260"></a>         <span class="k">call </span><span class="n">psi</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-261"></a>         <span class="k">call </span><span class="n">reg</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-262"></a>         <span class="k">call </span><span class="n">fxy</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-263"></a>         <span class="k">call </span><span class="n">cu</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-264"></a>         <span class="k">call </span><span class="n">dcu</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-265"></a>         <span class="k">call </span><span class="n">amu</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-266"></a>         <span class="k">call </span><span class="n">epw</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-267"></a>         <span class="k">call </span><span class="n">epwb</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-268"></a>         <span class="k">call </span><span class="n">bxyz</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-269"></a>
<a name="ln-270"></a>         <span class="k">if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsislice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-271"></a><span class="k">            allocate</span><span class="p">(</span><span class="n">psi3d</span><span class="p">)</span>
<a name="ln-272"></a>            <span class="k">call </span><span class="n">psi3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-273"></a>         <span class="k">end if</span>
<a name="ln-274"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjpslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-275"></a><span class="k">            allocate</span><span class="p">(</span><span class="n">cu3d</span><span class="p">)</span>
<a name="ln-276"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-277"></a>         <span class="k">end if</span>
<a name="ln-278"></a><span class="k">         </span>
<a name="ln-279"></a><span class="k">         allocate</span><span class="p">(</span><span class="n">pf</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">spe</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">))</span>
<a name="ln-280"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">pf3</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span><span class="p">),</span><span class="n">beam</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span><span class="p">))</span>
<a name="ln-281"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">qep</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">qe0</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">))</span>
<a name="ln-282"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">cu0</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">dcu0</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">amu0</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">))</span>
<a name="ln-283"></a>         
<a name="ln-284"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-285"></a>            <span class="k">call </span><span class="n">qep</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-286"></a>            <span class="k">call </span><span class="n">qe0</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-287"></a>            <span class="k">call </span><span class="n">cu0</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-288"></a>            <span class="k">call </span><span class="n">dcu0</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-289"></a>            <span class="k">call </span><span class="n">amu0</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="nb">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">fftflag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-290"></a>            <span class="k">call </span><span class="n">pf</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="n">npf</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">prof</span><span class="p">,</span><span class="n">npx</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npx</span><span class="p">,&amp;</span>
<a name="ln-291"></a>            <span class="p">&amp;</span><span class="n">npy</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npy</span><span class="p">,</span><span class="n">arg</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">arg</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">,:))</span>
<a name="ln-292"></a>            <span class="k">call </span><span class="n">spe</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp2</span><span class="p">,</span><span class="n">pf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qe0</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qm</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">q</span><span class="p">,&amp;</span>
<a name="ln-293"></a>            <span class="p">&amp;</span><span class="n">qbm</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">q</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">m</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dz</span><span class="p">,</span><span class="n">ci</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,&amp;</span>
<a name="ln-294"></a>            <span class="p">&amp;</span><span class="n">xdim</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">npmax</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npmax</span><span class="p">,</span><span class="n">nbmax</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.01</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">species</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npmax</span><span class="p">))</span>
<a name="ln-295"></a>         <span class="k">end do</span>
<a name="ln-296"></a><span class="k">         </span>
<a name="ln-297"></a><span class="k">         do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-298"></a>            <span class="k">call </span><span class="n">pf3</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="n">npf</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">prof</span><span class="p">,</span><span class="n">npx</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npx</span><span class="p">,&amp;</span>
<a name="ln-299"></a>            <span class="p">&amp;</span><span class="n">npy</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npy</span><span class="p">,</span><span class="n">npz</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npz</span><span class="p">,</span><span class="n">arg</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">arg</span><span class="p">)</span>
<a name="ln-300"></a>            <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">new</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">perr</span><span class="p">,</span><span class="n">psp3</span><span class="p">,</span><span class="n">pf3</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">qeb</span><span class="p">,</span><span class="n">qm</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">q</span><span class="p">,</span><span class="n">qbm</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">q</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-301"></a>            <span class="p">&amp;</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">m</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">ci</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">xdim</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">npmax</span><span class="o">=</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npmax</span><span class="p">,&amp;</span>
<a name="ln-302"></a>            <span class="p">&amp;</span><span class="n">nbmax</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">beam</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">npmax</span><span class="o">*</span><span class="mf">0.01</span><span class="p">))</span>
<a name="ln-303"></a>         <span class="k">end do</span>
<a name="ln-304"></a><span class="k">                     </span>
<a name="ln-305"></a><span class="k">         call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">timeunits</span> <span class="o">=</span> <span class="s1">&#39;1 / \omega_p&#39;</span><span class="p">,</span><span class="n">dt</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-306"></a>         <span class="p">&amp;</span><span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="o">/</span><span class="p">),</span> <span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-307"></a>         <span class="p">&amp;</span><span class="n">axisunits</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="p">,</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="p">,</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-308"></a>         <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="o">/</span><span class="p">),</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<a name="ln-309"></a>
<a name="ln-310"></a>         <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">timeunits</span> <span class="o">=</span> <span class="s1">&#39;1 / \omega_p&#39;</span><span class="p">,</span><span class="n">dt</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-311"></a>         <span class="p">&amp;</span><span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="o">/</span><span class="p">),</span> <span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-312"></a>         <span class="p">&amp;</span><span class="n">axisunits</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="p">,</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="p">,</span><span class="s1">&#39;c / \omega_p&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-313"></a>         <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="o">/</span><span class="p">),</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-314"></a>
<a name="ln-315"></a>         <span class="k">call </span><span class="n">filep</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">timeunits</span> <span class="o">=</span> <span class="s1">&#39;1 / \omega_p&#39;</span><span class="p">,</span><span class="n">dt</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">ty</span> <span class="o">=</span> <span class="s1">&#39;particles&#39;</span><span class="p">)</span>
<a name="ln-316"></a>
<a name="ln-317"></a>         <span class="k">call </span><span class="n">file_rst</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">ty</span><span class="o">=</span><span class="s1">&#39;rst&#39;</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<a name="ln-318"></a>         
<a name="ln-319"></a>         <span class="n">nstep2d</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">psp3</span><span class="p">%</span><span class="n">getindz</span><span class="p">()</span><span class="o">/</span><span class="n">pp</span><span class="p">%</span><span class="n">getnstage</span><span class="p">()</span>
<a name="ln-320"></a>         <span class="n">nstep3d</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="nb">time</span> <span class="o">/</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span>
<a name="ln-321"></a>         <span class="n">start3d</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-322"></a>         <span class="n">dex</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dx</span>
<a name="ln-323"></a>         <span class="n">dxi</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dz</span>
<a name="ln-324"></a>         <span class="n">dex2</span> <span class="o">=</span> <span class="n">dex</span> <span class="o">*</span> <span class="n">dex</span>
<a name="ln-325"></a>         <span class="n">iter</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">iter</span>
<a name="ln-326"></a>
<a name="ln-327"></a>         
<a name="ln-328"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">pp</span><span class="p">%</span><span class="n">getidproc</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-329"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./PSI&#39;</span><span class="p">)</span>
<a name="ln-330"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqep</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-331"></a><span class="k">               do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-332"></a>                  <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">stime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-333"></a>                  <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">))</span>
<a name="ln-334"></a>               <span class="k">end do</span>
<a name="ln-335"></a><span class="k">            end if</span>
<a name="ln-336"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqeb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-337"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEB&#39;</span><span class="p">)</span>
<a name="ln-338"></a>            <span class="k">end if</span>
<a name="ln-339"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-340"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPX&#39;</span><span class="p">)</span>
<a name="ln-341"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPY&#39;</span><span class="p">)</span>
<a name="ln-342"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPZ&#39;</span><span class="p">)</span>
<a name="ln-343"></a>            <span class="k">end if</span>
<a name="ln-344"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfe</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-345"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEX&#39;</span><span class="p">)</span>
<a name="ln-346"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEY&#39;</span><span class="p">)</span>
<a name="ln-347"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEZ&#39;</span><span class="p">)</span>
<a name="ln-348"></a>            <span class="k">end if</span>
<a name="ln-349"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-350"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBX&#39;</span><span class="p">)</span>
<a name="ln-351"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBY&#39;</span><span class="p">)</span>
<a name="ln-352"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBZ&#39;</span><span class="p">)</span>
<a name="ln-353"></a>            <span class="k">end if</span>
<a name="ln-354"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsislice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-355"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./PSI-XZ&#39;</span><span class="p">)</span>
<a name="ln-356"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./PSI-YZ&#39;</span><span class="p">)</span>
<a name="ln-357"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./PSI-XY&#39;</span><span class="p">)</span>
<a name="ln-358"></a>            <span class="k">end if</span>
<a name="ln-359"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqebslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-360"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEB-XZ&#39;</span><span class="p">)</span>
<a name="ln-361"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEB-YZ&#39;</span><span class="p">)</span>
<a name="ln-362"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEB-XY&#39;</span><span class="p">)</span>
<a name="ln-363"></a>            <span class="k">end if</span>
<a name="ln-364"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqepslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-365"></a><span class="k">               do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-366"></a>                  <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">stime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-367"></a>                  <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XZ&#39;</span><span class="p">)</span>
<a name="ln-368"></a>                  <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-YZ&#39;</span><span class="p">)</span>
<a name="ln-369"></a>                  <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XY&#39;</span><span class="p">)</span>
<a name="ln-370"></a>               <span class="k">end do</span>
<a name="ln-371"></a><span class="k">            end if</span>
<a name="ln-372"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjpslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-373"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPX-XZ&#39;</span><span class="p">)</span>
<a name="ln-374"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPX-YZ&#39;</span><span class="p">)</span>
<a name="ln-375"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPX-XY&#39;</span><span class="p">)</span>
<a name="ln-376"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPY-XZ&#39;</span><span class="p">)</span>
<a name="ln-377"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPY-YZ&#39;</span><span class="p">)</span>
<a name="ln-378"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPY-XY&#39;</span><span class="p">)</span>
<a name="ln-379"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPZ-XZ&#39;</span><span class="p">)</span>
<a name="ln-380"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPZ-YZ&#39;</span><span class="p">)</span>
<a name="ln-381"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./JPZ-XY&#39;</span><span class="p">)</span>
<a name="ln-382"></a>            <span class="k">end if</span>
<a name="ln-383"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfeslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-384"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEX-XZ&#39;</span><span class="p">)</span>
<a name="ln-385"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEX-YZ&#39;</span><span class="p">)</span>
<a name="ln-386"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEX-XY&#39;</span><span class="p">)</span>
<a name="ln-387"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEY-XZ&#39;</span><span class="p">)</span>
<a name="ln-388"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEY-YZ&#39;</span><span class="p">)</span>
<a name="ln-389"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEY-XY&#39;</span><span class="p">)</span>
<a name="ln-390"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEZ-XZ&#39;</span><span class="p">)</span>
<a name="ln-391"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEZ-YZ&#39;</span><span class="p">)</span>
<a name="ln-392"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FEZ-XY&#39;</span><span class="p">)</span>
<a name="ln-393"></a>            <span class="k">end if</span>
<a name="ln-394"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfbslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-395"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBX-XZ&#39;</span><span class="p">)</span>
<a name="ln-396"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBX-YZ&#39;</span><span class="p">)</span>
<a name="ln-397"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBX-XY&#39;</span><span class="p">)</span>
<a name="ln-398"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBY-XZ&#39;</span><span class="p">)</span>
<a name="ln-399"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBY-YZ&#39;</span><span class="p">)</span>
<a name="ln-400"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBY-XY&#39;</span><span class="p">)</span>
<a name="ln-401"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBZ-XZ&#39;</span><span class="p">)</span>
<a name="ln-402"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBZ-YZ&#39;</span><span class="p">)</span>
<a name="ln-403"></a>               <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./FBZ-XY&#39;</span><span class="p">)</span>
<a name="ln-404"></a>            <span class="k">end if</span>
<a name="ln-405"></a><span class="k">            if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dump_beam_raw</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-406"></a><span class="k">               call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./RAW-BEAM&#39;</span><span class="p">)</span>
<a name="ln-407"></a>               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-408"></a>                  <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">stime</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-409"></a>                  <span class="k">call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./RAW-BEAM/&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">))</span>
<a name="ln-410"></a>               <span class="k">end do</span>
<a name="ln-411"></a><span class="k">            end if</span>
<a name="ln-412"></a><span class="k">            if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">read_rst_file</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-413"></a><span class="k">               if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">dump_rst_file</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-414"></a><span class="k">                  call </span><span class="nb">system</span><span class="p">(</span><span class="s1">&#39;mkdir ./RST&#39;</span><span class="p">)</span>
<a name="ln-415"></a>               <span class="k">end if</span>
<a name="ln-416"></a><span class="k">            end if</span>
<a name="ln-417"></a><span class="k">         end if</span>
<a name="ln-418"></a>
<a name="ln-419"></a><span class="k">         if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">read_rst_file</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-420"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-421"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-422"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">pp</span><span class="p">%</span><span class="n">getidproc</span><span class="p">(),</span><span class="n">sid</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-423"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">rst_timestep</span><span class="p">,</span><span class="n">stime</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>                  
<a name="ln-424"></a>               <span class="k">call </span><span class="n">file_rst</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./RST/RST-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-425"></a>               <span class="p">&amp;</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;RST-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-426"></a>               <span class="p">&amp;</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">))</span>
<a name="ln-427"></a>               <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">rrst</span><span class="p">(</span><span class="n">file_rst</span><span class="p">)</span>
<a name="ln-428"></a>             <span class="k">end do</span>
<a name="ln-429"></a><span class="k">             </span><span class="n">start3d</span> <span class="o">=</span> <span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">rst_timestep</span>
<a name="ln-430"></a>         <span class="k">end if</span>
<a name="ln-431"></a>
<a name="ln-432"></a><span class="k">         call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">pp</span><span class="p">%</span><span class="n">getlworld</span><span class="p">(),</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-433"></a>
<a name="ln-434"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">tag_spe</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">id_spe</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">))</span>
<a name="ln-435"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">id_qep</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">),</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span><span class="p">))</span>
<a name="ln-436"></a>         <span class="k">allocate</span><span class="p">(</span><span class="n">tag_beam</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span><span class="p">),</span><span class="n">id_beam</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span><span class="p">),</span><span class="n">id_br</span><span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span><span class="p">))</span>
<a name="ln-437"></a>         <span class="n">id</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>
<a name="ln-438"></a>         <span class="n">id_spe</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>
<a name="ln-439"></a>         <span class="n">id_qep</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>
<a name="ln-440"></a>         <span class="n">id_qeps</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>
<a name="ln-441"></a>         <span class="n">id_beam</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>                 
<a name="ln-442"></a>         <span class="n">id_br</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">MPI_REQUEST_NULL</span>                 
<a name="ln-443"></a>
<a name="ln-444"></a>      <span class="k">end subroutine </span><span class="n">initialization</span>     
<a name="ln-445"></a><span class="c">!</span>
<a name="ln-446"></a>      <span class="k">subroutine </span><span class="n">diagnostic</span><span class="p">()</span>
<a name="ln-447"></a>         <span class="k">implicit none</span>
<a name="ln-448"></a><span class="k">         </span>
<a name="ln-449"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sn</span><span class="p">,</span> <span class="n">sid</span>
<a name="ln-450"></a>         
<a name="ln-451"></a>         <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">stime</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>                  
<a name="ln-452"></a>         
<a name="ln-453"></a>         <span class="k">if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqeb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqeb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-454"></a><span class="k">            call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEB/QEB_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-455"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEB&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEB&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-456"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-457"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-458"></a>            <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a name="ln-459"></a>         <span class="k">end if</span>
<a name="ln-460"></a>
<a name="ln-461"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqep</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqep</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-462"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-463"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-464"></a>               <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-465"></a>               <span class="p">&amp;</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-466"></a>               <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">),</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">),&amp;</span>
<a name="ln-467"></a>               <span class="p">&amp;</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-468"></a>               <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-469"></a>               <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_qep</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-470"></a>               <span class="k">call </span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id_qep</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-471"></a>            <span class="k">end do</span>
<a name="ln-472"></a><span class="k">         end if</span>
<a name="ln-473"></a>
<a name="ln-474"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-475"></a><span class="k">            call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./PSI/PSI_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-476"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;PSI&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc^2&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSI&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-477"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-478"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-479"></a>            <span class="k">call </span><span class="n">psi3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<a name="ln-480"></a>         <span class="k">end if</span>
<a name="ln-481"></a>
<a name="ln-482"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjp</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-483"></a><span class="k">            call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPX/JPX_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-484"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPX&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPX&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-485"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-486"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-487"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span>
<a name="ln-488"></a>
<a name="ln-489"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPY/JPY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-490"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-491"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-492"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-493"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
<a name="ln-494"></a>            
<a name="ln-495"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPZ/JPZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-496"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-497"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-498"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-499"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>            
<a name="ln-500"></a>         <span class="k">end if</span>
<a name="ln-501"></a>
<a name="ln-502"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfe</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfe</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-503"></a><span class="k">            call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEX/FEX_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-504"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEX&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEX&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-505"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-506"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-507"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<a name="ln-508"></a>
<a name="ln-509"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEY/FEY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-510"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-511"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-512"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-513"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<a name="ln-514"></a>            
<a name="ln-515"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEZ/FEZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-516"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-517"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-518"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-519"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span>            
<a name="ln-520"></a>         <span class="k">end if         </span>
<a name="ln-521"></a>
<a name="ln-522"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-523"></a><span class="k">            call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBX/FBX_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-524"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBX&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBX&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-525"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-526"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-527"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span>
<a name="ln-528"></a>
<a name="ln-529"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBY/FBY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-530"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-531"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-532"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-533"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<a name="ln-534"></a>            
<a name="ln-535"></a>            <span class="k">call </span><span class="n">file3d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBZ/FBZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-536"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">)</span>
<a name="ln-537"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-538"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-539"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file3d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span>            
<a name="ln-540"></a>         <span class="k">end if         </span>
<a name="ln-541"></a>
<a name="ln-542"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqebslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqebslice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-543"></a><span class="k">            call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEB-XZ/QEB-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-544"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEB-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEB-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-545"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;z  &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-546"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;z  &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-547"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-548"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-549"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">22</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-550"></a>            <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qeby0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>
<a name="ln-551"></a>
<a name="ln-552"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEB-YZ/QEB-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-553"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEB-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEB-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-554"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-555"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-556"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-557"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-558"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-559"></a>            <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qebx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
<a name="ln-560"></a>
<a name="ln-561"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEB-XY/QEB-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-562"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEB-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEB-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-563"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-564"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-565"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-566"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-567"></a>            <span class="k">call </span><span class="n">qeb</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qebz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-568"></a>
<a name="ln-569"></a>         <span class="k">end if</span>
<a name="ln-570"></a>
<a name="ln-571"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqepslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfqepslice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-572"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nspecies</span>
<a name="ln-573"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-574"></a>               <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XZ/QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-575"></a>               <span class="p">&amp;</span><span class="s1">&#39;-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-576"></a>               <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,&amp;</span>
<a name="ln-577"></a>               <span class="p">&amp;</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XZ&#39;</span><span class="p">,&amp;</span>
<a name="ln-578"></a>               <span class="p">&amp;</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-579"></a>               <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axismax</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-580"></a>               <span class="p">&amp;</span><span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-581"></a>               <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-582"></a>               <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-583"></a>               <span class="k">call </span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qepy0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-584"></a>
<a name="ln-585"></a>               <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-YZ/QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-586"></a>               <span class="p">&amp;</span><span class="s1">&#39;-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-587"></a>               <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,&amp;</span>
<a name="ln-588"></a>               <span class="p">&amp;</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-YZ&#39;</span><span class="p">,&amp;</span>
<a name="ln-589"></a>               <span class="p">&amp;</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-590"></a>               <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axismax</span><span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-591"></a>               <span class="p">&amp;</span><span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-592"></a>               <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-593"></a>               <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-594"></a>               <span class="k">call </span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qepx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-595"></a>
<a name="ln-596"></a>               <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XY/QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-597"></a>               <span class="p">&amp;</span><span class="s1">&#39;-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-598"></a>               <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0&#39;</span><span class="p">,&amp;</span>
<a name="ln-599"></a>               <span class="p">&amp;</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;QEP&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-XY&#39;</span><span class="p">,&amp;</span>
<a name="ln-600"></a>               <span class="p">&amp;</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-601"></a>               <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-602"></a>               <span class="p">&amp;</span><span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-603"></a>               <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-604"></a>               <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-605"></a>               <span class="k">call </span><span class="n">qep</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">qepz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id_qeps</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<a name="ln-606"></a>            <span class="k">end do</span>
<a name="ln-607"></a><span class="k">         end if</span>
<a name="ln-608"></a>
<a name="ln-609"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsislice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfpsislice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-610"></a><span class="k">            call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./PSI-XZ/PSI-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-611"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;PSI-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc^2&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSI-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-612"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-613"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-614"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-615"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-616"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-617"></a>            <span class="k">call </span><span class="n">psi3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">psiy0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<a name="ln-618"></a>
<a name="ln-619"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./PSI-YZ/PSI-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-620"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;PSI-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc^2&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSI-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-621"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-622"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-623"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-624"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-625"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">26</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-626"></a>            <span class="k">call </span><span class="n">psi3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">psix0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span>
<a name="ln-627"></a>
<a name="ln-628"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./PSI-XY/PSI-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-629"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;PSI-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc^2&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PSI-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-630"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-631"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-632"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-633"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-634"></a>            <span class="k">call </span><span class="n">psi3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">psiz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span>
<a name="ln-635"></a>         <span class="k">end if</span>
<a name="ln-636"></a>
<a name="ln-637"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjpslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfjpslice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-638"></a><span class="k">            call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPX-XZ/JPX-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-639"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPX-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPX-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-640"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-641"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-642"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-643"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-644"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">28</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-645"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpy0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
<a name="ln-646"></a>
<a name="ln-647"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPX-YZ/JPX-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-648"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPX-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPX-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-649"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-650"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-651"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-652"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-653"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-654"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span>
<a name="ln-655"></a>
<a name="ln-656"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPX-XY/JPX-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-657"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPX-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPX-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-658"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-659"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-660"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-661"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-662"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<a name="ln-663"></a>
<a name="ln-664"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPY-XZ/JPY-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-665"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPY-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPY-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-666"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-667"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-668"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-669"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-670"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-671"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpy0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<a name="ln-672"></a>
<a name="ln-673"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPY-YZ/JPY-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-674"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPY-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPY-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-675"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-676"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-677"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-678"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-679"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-680"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<a name="ln-681"></a>
<a name="ln-682"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPY-XY/JPY-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-683"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPY-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPY-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-684"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-685"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-686"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-687"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">33</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-688"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span>
<a name="ln-689"></a>
<a name="ln-690"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPZ-XZ/JPZ-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-691"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPZ-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPZ-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-692"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-693"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-694"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-695"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-696"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">34</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-697"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpy0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span>
<a name="ln-698"></a>
<a name="ln-699"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPZ-YZ/JPZ-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-700"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPZ-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPZ-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-701"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-702"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-703"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-704"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-705"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">35</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-706"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span>
<a name="ln-707"></a>
<a name="ln-708"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./JPZ-XY/JPZ-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-709"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;JPZ-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;n_0c&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;JPZ-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-710"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-711"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-712"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-713"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-714"></a>            <span class="k">call </span><span class="n">cu3d</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">jpz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<a name="ln-715"></a>
<a name="ln-716"></a>         <span class="k">end if</span>
<a name="ln-717"></a>
<a name="ln-718"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfeslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfeslice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-719"></a><span class="k">            call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEX-XZ/FEX-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-720"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEX-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEX-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-721"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-722"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-723"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-724"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-725"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-726"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ey0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span>
<a name="ln-727"></a>
<a name="ln-728"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEX-YZ/FEX-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-729"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEX-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEX-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-730"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-731"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-732"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-733"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-734"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">38</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-735"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ex0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span>
<a name="ln-736"></a>
<a name="ln-737"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEX-XY/FEX-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-738"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEX-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEX-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-739"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-740"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-741"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-742"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-743"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">39</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-744"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ez0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span>
<a name="ln-745"></a>
<a name="ln-746"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEY-XZ/FEY-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-747"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEY-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEY-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-748"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-749"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-750"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-751"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-752"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-753"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ey0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<a name="ln-754"></a>
<a name="ln-755"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEY-YZ/FEY-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-756"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEY-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEY-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-757"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-758"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-759"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-760"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-761"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">41</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-762"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ex0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span>
<a name="ln-763"></a>
<a name="ln-764"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEY-XY/FEY-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-765"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEY-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEY-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-766"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-767"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-768"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-769"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-770"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">42</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-771"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ez0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
<a name="ln-772"></a>
<a name="ln-773"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEZ-XZ/FEZ-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-774"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEZ-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEZ-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-775"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-776"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-777"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-778"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-779"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">43</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-780"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ey0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span>
<a name="ln-781"></a>
<a name="ln-782"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEZ-YZ/FEZ-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-783"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEZ-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEZ-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-784"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-785"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-786"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-787"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-788"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">44</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-789"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ex0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span>
<a name="ln-790"></a>
<a name="ln-791"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FEZ-XY/FEZ-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-792"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FEZ-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FEZ-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-793"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-794"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-795"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-796"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-797"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-798"></a>            <span class="k">call </span><span class="n">bexyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">ez0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
<a name="ln-799"></a>         <span class="k">end if</span>
<a name="ln-800"></a>
<a name="ln-801"></a><span class="k">         if</span> <span class="p">((</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfbslice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfbslice</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-802"></a><span class="k">            call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBX-XZ/FBX-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-803"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBX-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBX-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-804"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-805"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-806"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-807"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-808"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">46</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-809"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">by0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span>
<a name="ln-810"></a>
<a name="ln-811"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBX-YZ/FBX-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-812"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBX-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBX-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-813"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-814"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-815"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-816"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-817"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">47</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-818"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span>
<a name="ln-819"></a>
<a name="ln-820"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBX-XY/FBX-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-821"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBX-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBX-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-822"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-823"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-824"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-825"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-826"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">48</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-827"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span>
<a name="ln-828"></a>
<a name="ln-829"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBY-XZ/FBY-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-830"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBY-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBY-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-831"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-832"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-833"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-834"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-835"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">49</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-836"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">by0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span>
<a name="ln-837"></a>
<a name="ln-838"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBY-YZ/FBY-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-839"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBY-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBY-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-840"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-841"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-842"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-843"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-844"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-845"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<a name="ln-846"></a>
<a name="ln-847"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBY-XY/FBY-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-848"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBY-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBY-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-849"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-850"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-851"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-852"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-853"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">51</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-854"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span>
<a name="ln-855"></a>
<a name="ln-856"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBZ-XZ/FBZ-XZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-857"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBZ-XZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBZ-XZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-858"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-859"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-860"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-861"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-862"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">52</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-863"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">by0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span>
<a name="ln-864"></a>
<a name="ln-865"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBZ-YZ/FBZ-YZ_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-866"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBZ-YZ&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBZ-YZ&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-867"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-868"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-869"></a>            <span class="p">&amp;</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;y  &#39;</span><span class="p">,</span><span class="s1">&#39;\xi&#39;</span><span class="p">,</span><span class="s1">&#39;x3 &#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-870"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lz</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-871"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-872"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">53</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-873"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bx0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span>
<a name="ln-874"></a>
<a name="ln-875"></a>            <span class="k">call </span><span class="n">file2d</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./FBZ-XY/FBZ-XY_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-876"></a>            <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;FBZ-XY&#39;</span><span class="p">,</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;mc\omega_p/e&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FBZ-XY&#39;</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,&amp;</span>
<a name="ln-877"></a>            <span class="p">&amp;</span><span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-878"></a>            <span class="p">&amp;</span><span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axisname</span>  <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),</span><span class="n">axislabel</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-879"></a>            <span class="p">&amp;</span><span class="n">axismax</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">lx</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">ly</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="p">),</span> <span class="n">axismin</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="o">/</span><span class="p">))</span>
<a name="ln-880"></a>            <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-881"></a>            <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="mi">54</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-882"></a>            <span class="k">call </span><span class="n">bbxyz</span><span class="p">%</span><span class="n">wr</span><span class="p">(</span><span class="n">file2d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">bz0</span><span class="p">,</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span>
<a name="ln-883"></a>         <span class="k">end if</span>
<a name="ln-884"></a>
<a name="ln-885"></a><span class="k">         if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dump_beam_raw</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">dfbeam_raw</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-886"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-887"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-888"></a>               <span class="k">call </span><span class="n">filep</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./RAW-BEAM/&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;/RAW-BEAM-&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-889"></a>               <span class="p">&amp;</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,&amp;</span>
<a name="ln-890"></a>               <span class="p">&amp;</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;RAW-BEAM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">),</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,&amp;</span>
<a name="ln-891"></a>               <span class="p">&amp;</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;RAW-BEAM-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">),</span><span class="n">n</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">dt</span><span class="p">,&amp;</span>
<a name="ln-892"></a>               <span class="p">&amp;</span><span class="n">ty</span><span class="o">=</span><span class="s1">&#39;particles&#39;</span><span class="p">)</span>
<a name="ln-893"></a>               <span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ntag</span><span class="p">()</span>
<a name="ln-894"></a>               <span class="k">call </span><span class="n">MPI_WAIT</span><span class="p">(</span><span class="n">id_br</span><span class="p">(</span><span class="n">m</span><span class="p">),</span><span class="n">istat</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<a name="ln-895"></a>               <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wr</span><span class="p">(</span><span class="n">filep</span><span class="p">,</span><span class="n">sim</span><span class="p">%</span><span class="n">diag</span><span class="p">%</span><span class="n">beam_raw_factor</span><span class="p">,(</span><span class="o">/</span><span class="n">dex</span><span class="p">,</span><span class="n">dex</span><span class="p">,</span><span class="n">dxi</span><span class="o">/</span><span class="p">),&amp;</span>
<a name="ln-896"></a>               <span class="p">&amp;</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tag</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">id_br</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>         
<a name="ln-897"></a>            <span class="k">end do</span>
<a name="ln-898"></a><span class="k">         end if</span>
<a name="ln-899"></a>
<a name="ln-900"></a><span class="k">         if</span> <span class="p">(</span><span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">dump_rst_file</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="nb">mod</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">sim</span><span class="p">%</span><span class="n">res</span><span class="p">%</span><span class="n">dfrst</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-901"></a><span class="k">            do </span><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sim</span><span class="p">%</span><span class="n">sim</span><span class="p">%</span><span class="n">nbeams</span>
<a name="ln-902"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<a name="ln-903"></a>               <span class="k">call </span><span class="n">str</span><span class="p">(</span><span class="n">pp</span><span class="p">%</span><span class="n">getidproc</span><span class="p">(),</span><span class="n">sid</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-904"></a>               <span class="k">call </span><span class="n">file_rst</span><span class="p">%</span><span class="n">new</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;./RST/RST-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-905"></a>               <span class="p">&amp;</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.h5&#39;</span><span class="p">,</span><span class="n">dataname</span> <span class="o">=</span> <span class="s1">&#39;RST-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sn</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;-&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">sid</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-906"></a>               <span class="p">&amp;</span><span class="s1">&#39;_&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">stime</span><span class="p">))</span>
<a name="ln-907"></a>               <span class="k">call </span><span class="n">beam</span><span class="p">(</span><span class="n">m</span><span class="p">)%</span><span class="n">wrst</span><span class="p">(</span><span class="n">file_rst</span><span class="p">)</span>
<a name="ln-908"></a>             <span class="k">end do</span>
<a name="ln-909"></a><span class="k">         end if</span>
<a name="ln-910"></a>
<a name="ln-911"></a><span class="k">      end subroutine </span><span class="n">diagnostic</span>
<a name="ln-912"></a><span class="c">!</span>
<a name="ln-913"></a>      <span class="k">subroutine </span><span class="n">str</span><span class="p">(</span><span class="n">int_in</span><span class="p">,</span><span class="n">string</span><span class="p">,</span><span class="n">ndigits</span><span class="p">)</span>
<a name="ln-914"></a>
<a name="ln-915"></a>      <span class="k">implicit none</span>
<a name="ln-916"></a><span class="k">      </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">int_in</span><span class="p">,</span> <span class="n">ndigits</span>
<a name="ln-917"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-918"></a>      
<a name="ln-919"></a><span class="c">! local variables      </span>
<a name="ln-920"></a>      <span class="kt">integer</span>  <span class="kd">::</span>  <span class="n">izero</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">nd</span><span class="p">,</span> <span class="n">m</span>
<a name="ln-921"></a>      <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">chindx</span> 
<a name="ln-922"></a>      
<a name="ln-923"></a>      <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> 
<a name="ln-924"></a>      <span class="n">izero</span> <span class="o">=</span>  <span class="nb">ichar</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<a name="ln-925"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">ndigits</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="k">then </span>
<a name="ln-926"></a><span class="k">         </span><span class="n">nd</span> <span class="o">=</span> <span class="mi">20</span>
<a name="ln-927"></a>      <span class="k">else</span>
<a name="ln-928"></a><span class="k">         </span><span class="n">nd</span> <span class="o">=</span> <span class="n">ndigits</span>
<a name="ln-929"></a>      <span class="n">endif</span>
<a name="ln-930"></a>      <span class="n">chindx</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-931"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">nd</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> 
<a name="ln-932"></a>         <span class="n">m</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-933"></a>         <span class="n">chindx</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">chindx</span><span class="p">)</span> <span class="o">//</span> <span class="nb">char</span><span class="p">(</span>  <span class="n">izero</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span> <span class="n">int_in</span><span class="o">/</span><span class="n">m</span> <span class="p">,</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span> 
<a name="ln-934"></a>      <span class="n">enddo</span> 
<a name="ln-935"></a>      <span class="n">string</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">chindx</span><span class="p">)</span>
<a name="ln-936"></a>
<a name="ln-937"></a>      <span class="k">end subroutine </span><span class="n">str</span>    
<a name="ln-938"></a><span class="c">!                </span>
<a name="ln-939"></a>      <span class="k">function </span><span class="n">ntag</span><span class="p">()</span>
<a name="ln-940"></a>      
<a name="ln-941"></a>         <span class="k">implicit none</span>
<a name="ln-942"></a><span class="k">         </span><span class="kt">integer</span><span class="p">,</span> <span class="k">save</span> <span class="kd">::</span> <span class="n">tag</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-943"></a>         <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntag</span>
<a name="ln-944"></a>                 
<a name="ln-945"></a>         <span class="n">ntag</span> <span class="o">=</span> <span class="n">tag</span>
<a name="ln-946"></a>         <span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-947"></a>      
<a name="ln-948"></a>      <span class="k">end function </span><span class="n">ntag</span>
<a name="ln-949"></a>                  
<a name="ln-950"></a>      <span class="k">end program </span><span class="n">quickpic</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2018 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> QuickPIC was developed by Weiming An</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>